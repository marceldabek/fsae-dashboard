const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DrAM74WJ.js","assets/index-5YhivlxY.css"])))=>i.map(i=>d[i]);
import{c as Dt,i as At,r,_ as b,f as O,a as Z,e as nt,j as e,n as Rt,o as Et,p as Lt,q as at,s as ot,l as rt,b as Tt,t as It,v as Mt,w as Ot,x as Ft}from"./index-DrAM74WJ.js";function Ut(){const F=Dt(),it=At((F==null?void 0:F.uid)||null),[j,h]=r.useState([]),[N,x]=r.useState([]),[S,ee]=r.useState(null),[C,R]=r.useState(null),[te,B]=r.useState(""),[se,U]=r.useState(""),[ne,ae]=r.useState(""),[oe,re]=r.useState("Senior"),[ie,le]=r.useState(""),[de,ce]=r.useState(""),[me,ue]=r.useState(""),[V,pe]=r.useState(""),[he,xe]=r.useState([]),[be,je]=r.useState(""),[ge,fe]=r.useState(""),[we,ve]=r.useState(""),[ye,Ne]=r.useState(""),[$,lt]=r.useState(""),[z,Se]=r.useState(""),[ke,Ce]=r.useState(""),[_e,Pe]=r.useState("In Progress"),[De,Ae]=r.useState(""),[Re,Ee]=r.useState(""),[Y,Le]=r.useState(""),[Te,dt]=r.useState(""),[G,ct]=r.useState(""),[P,Ie]=r.useState([]),[k,mt]=r.useState("subsystem"),[q,ut]=r.useState("asc"),[Me,E]=r.useState(!1),[Oe,D]=r.useState(!1),[p,L]=r.useState("people"),[pt,T]=r.useState(!1),[W,Fe]=r.useState(""),[Be,ht]=r.useState(!1),[Ue,Ve]=r.useState(!1),[$e,J]=r.useState([]),[ze,Ye]=r.useState(()=>new Date().toISOString().slice(0,10)),[X,Ge]=r.useState({}),[H,qe]=r.useState({}),[xt,I]=r.useState(!1),[bt,M]=r.useState(!1),[K,We]=r.useState(""),[g,Q]=r.useState(null),[jt,Je]=r.useState(!1),[Xe,_]=r.useState("");r.useEffect(()=>{(async()=>{const{fetchRankedSettings:t}=await b(async()=>{const{fetchRankedSettings:l}=await import("./index-DrAM74WJ.js").then(u=>u.D);return{fetchRankedSettings:l}},__vite__mapDeps([0,1])),{fetchRecentLogs:s}=await b(async()=>{const{fetchRecentLogs:l}=await import("./index-DrAM74WJ.js").then(u=>u.D);return{fetchRecentLogs:l}},__vite__mapDeps([0,1])),[a,n,o,i,d]=await Promise.all([O(),Z(),nt(),t(),s(50)]);h(a),x(n),ee(o),R(i),J(d),B((o==null?void 0:o.rulebook_url)||""),U((o==null?void 0:o.sharepoint_url)||""),Ge({...(i==null?void 0:i.promotion_pct)||{}}),qe({...(i==null?void 0:i.demotion_pct)||{}}),I(!1)})()},[]),r.useEffect(()=>{B((S==null?void 0:S.rulebook_url)||""),U((S==null?void 0:S.sharepoint_url)||"")},[S]);const gt=t=>xe(s=>s.includes(t)?s.filter(a=>a!==t):[...s,t]),[He,Ke]=r.useState("");function c(t){Ke(t),setTimeout(()=>Ke(""),3e3)}async function ft(){try{await Ot({rulebook_url:te.trim()||void 0,sharepoint_url:se.trim()||void 0}),ee(await nt()),c("Settings saved")}catch(t){console.error(t),c("Save failed")}}async function wt(){try{await Ft(),h([]),x([]),c("System reset complete")}catch(t){console.error(t),c("Reset failed")}}async function vt(){try{const t=await at({name:ne.trim(),year:oe,role:de.trim()||void 0,skills:ie.split(",").map(s=>s.trim()).filter(Boolean),discord:me.trim()||void 0});h(await O()),ae(""),re("Senior"),ce(""),le(""),ue(""),c("Person saved")}catch(t){console.error(t),c("Save failed")}}async function yt(){if(!V.trim())return alert("Give the project a name");try{const t=await ot({name:V.trim(),owner_ids:he,design_link:be.trim()||void 0,description:ge.trim()||void 0,due_date:we||void 0,subsystem:ye||void 0});x(await Z()),pe(""),xe([]),je(""),fe(""),ve(""),Ne(""),c("Project saved")}catch(t){console.error(t),c("Save failed")}}async function Nt(){if(!z)return alert("Choose a project");try{const t=await rt({project_id:z,description:ke.trim(),status:_e,assignee_id:De||void 0,ranked_points:Re||void 0});Se(""),Ce(""),Pe("In Progress"),Ae(""),Ee(""),c("Task saved")}catch(t){console.error(t),c("Save failed")}}const Qe=r.useMemo(()=>{const t=new Set;for(const s of N)s.subsystem&&t.add(s.subsystem);return Array.from(t).sort()},[N]),St=r.useMemo(()=>{const t=new Map;for(const s of N)s.subsystem&&t.set(s.subsystem,(t.get(s.subsystem)||0)+1);return t},[N]),Ze=P.length?N.filter(t=>t.subsystem&&P.includes(t.subsystem)):N,kt=r.useMemo(()=>{const t=G.toLowerCase();return[...Ze.filter(n=>t?n.name.toLowerCase().includes(t)||(n.description||"").toLowerCase().includes(t):!0)].sort((n,o)=>{let i=0;return k==="name"?i=n.name.localeCompare(o.name):k==="due"?i=(n.due_date||"").localeCompare(o.due_date||""):i=(n.subsystem||"").localeCompare(o.subsystem||"")||n.name.localeCompare(o.name),q==="asc"?i:-i})},[Ze,G,k,q]),et=t=>t==="name"?"Name":t==="due"?"Due date":"Subsystem",tt=q==="asc"?"↑":"↓";return r.useEffect(()=>{const t=s=>{s.key==="Escape"&&(E(!1),D(!1))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]),it?e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-1",children:"Admin"}),He&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 px-4 py-2 rounded bg-brand-teal text-black shadow-lg text-sm font-medium animate-fade-in",children:He}),e.jsx("div",{className:"sticky top-0 z-30 -mx-4 px-4 bg-transparent backdrop-blur-none border-b border-uconn-border/60",children:e.jsxs("nav",{className:"flex gap-3 h-11 items-end",role:"tablist",children:[e.jsx("button",{role:"tab","aria-selected":p==="people",onClick:()=>L("people"),className:`px-3 pb-2 pt-2 border-b-2 ${p==="people"?"border-brand-teal text-white":"border-transparent text-uconn-muted hover:text-white"}`,children:"People"}),e.jsx("button",{role:"tab","aria-selected":p==="projects",onClick:()=>L("projects"),className:`px-3 pb-2 pt-2 border-b-2 ${p==="projects"?"border-brand-teal text-white":"border-transparent text-uconn-muted hover:text-white"}`,children:"Projects & Tasks"}),e.jsx("button",{role:"tab","aria-selected":p==="settings",onClick:()=>L("settings"),className:`px-3 pb-2 pt-2 border-b-2 ${p==="settings"?"border-brand-teal text-white":"border-transparent text-uconn-muted hover:text-white"}`,children:"Global Settings"}),e.jsx("button",{role:"tab","aria-selected":p==="ranked",onClick:()=>L("ranked"),className:`px-3 pb-2 pt-2 border-b-2 ${p==="ranked"?"border-brand-teal text-white":"border-transparent text-uconn-muted hover:text-white"}`,children:"Ranked Settings"})]})}),p==="people"&&e.jsx("div",{role:"tabpanel",className:"mt-4",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("section",{className:"space-y-2",children:[e.jsx("h2",{className:"font-semibold",children:"Create Person"}),e.jsxs("div",{className:"form-section p-4 space-y-3",children:[e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"Name",value:ne,onChange:t=>ae(t.target.value)}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{className:"px-3 py-2 rounded dark-select",value:oe,onChange:t=>re(t.target.value),children:[e.jsx("option",{children:"Freshman"}),e.jsx("option",{children:"Sophomore"}),e.jsx("option",{children:"Junior"}),e.jsx("option",{children:"Senior"}),e.jsx("option",{children:"Graduate"})]}),e.jsx("input",{className:"px-3 py-2 rounded flex-1",placeholder:"Role (optional)",value:de,onChange:t=>ce(t.target.value)})]}),e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"Skills (comma-separated)",value:ie,onChange:t=>le(t.target.value)}),e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"Discord (e.g., username)",value:me,onChange:t=>ue(t.target.value)}),e.jsx("button",{onClick:vt,className:"px-3 py-2 rounded bg-white/10 border border-uconn-border",children:"Save Person"}),e.jsxs("div",{className:"pt-3 border-t border-white/10 mt-3",children:[e.jsx("div",{className:"text-xs text-uconn-muted mb-1",children:"Quick attendance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",className:"px-2.5 py-1.5 rounded text-sm bg-white/5 border border-white/10",value:ze,onChange:t=>Ye(t.target.value)}),e.jsxs("select",{className:"px-2.5 py-1.5 rounded dark-select text-sm flex-1",value:Y,onChange:t=>Le(t.target.value),children:[e.jsx("option",{value:"",children:"Select person…"}),j.slice().sort((t,s)=>t.name.localeCompare(s.name)).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("button",{className:"px-2.5 py-1.5 rounded border border-uconn-border bg-white/10 text-xs whitespace-nowrap",onClick:async()=>{if(!Y)return alert("Select a person");const t=ze||new Date().toISOString().slice(0,10);await Rt({person_id:Y,date:t,points:10}),Le(""),Ye(new Date().toISOString().slice(0,10)),c("Attendance recorded (10 pts)")},children:"Give 10 pts"})]})]})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"font-semibold",children:"People"}),e.jsx("input",{className:"px-3 py-2 rounded text-sm w-56",placeholder:"Search people…",value:Te,onChange:t=>dt(t.target.value)})]}),e.jsx("div",{className:"space-y-4",children:j.filter(t=>{const s=Te.toLowerCase();return s?t.name.toLowerCase().includes(s)||(t.skills||[]).some(a=>a.toLowerCase().includes(s))||(t.role||"").toLowerCase().includes(s):!0}).sort((t,s)=>t.name.localeCompare(s.name)).map(t=>e.jsxs("details",{className:"rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("summary",{className:"cursor-pointer font-medium px-3 py-2 flex items-center justify-between",children:[e.jsx("span",{className:"truncate",children:t.name}),e.jsx("span",{className:"text-xs text-uconn-muted ml-2 truncate",children:t.role||t.year||""})]}),e.jsxs("div",{className:"px-3 pb-3 mt-1 grid sm:grid-cols-2 gap-4",children:[e.jsx("input",{className:"px-3 py-2 rounded",value:t.name,onChange:s=>h(a=>a.map(n=>n.id===t.id?{...n,name:s.target.value}:n))}),e.jsxs("select",{className:"px-3 py-2 rounded dark-select",value:t.year||"Senior",onChange:s=>h(a=>a.map(n=>n.id===t.id?{...n,year:s.target.value}:n)),children:[e.jsx("option",{children:"Freshman"}),e.jsx("option",{children:"Sophomore"}),e.jsx("option",{children:"Junior"}),e.jsx("option",{children:"Senior"}),e.jsx("option",{children:"Graduate"})]}),e.jsx("input",{className:"px-3 py-2 rounded",placeholder:"Role",value:t.role||"",onChange:s=>h(a=>a.map(n=>n.id===t.id?{...n,role:s.target.value}:n))}),e.jsx("input",{className:"px-3 py-2 rounded",placeholder:"Discord",value:t.discord||"",onChange:s=>h(a=>a.map(n=>n.id===t.id?{...n,discord:s.target.value}:n))}),e.jsx("input",{className:"px-3 py-2 rounded sm:col-span-2",placeholder:"Skills (comma-separated)",value:(t.skills||[]).join(", "),onChange:s=>h(a=>a.map(n=>n.id===t.id?{...n,skills:s.target.value.split(",").map(o=>o.trim()).filter(Boolean)}:n))}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:col-span-2 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-uconn-muted",children:"Rank"}),e.jsxs("select",{className:"mt-1 px-3 py-2 rounded w-full dark-select",value:t.rank||"Bronze",onChange:s=>h(a=>a.map(n=>n.id===t.id?{...n,rank:s.target.value}:n)),children:[e.jsx("option",{children:"Bronze"}),e.jsx("option",{children:"Silver"}),e.jsx("option",{children:"Gold"}),e.jsx("option",{children:"Platinum"}),e.jsx("option",{children:"Diamond"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-uconn-muted",children:"Ranked pool"}),e.jsxs("label",{className:"mt-1 flex items-center gap-3 select-none",children:[e.jsx("input",{type:"checkbox",className:"peer sr-only",checked:!!t.ranked_opt_in,onChange:s=>h(a=>a.map(n=>n.id===t.id?{...n,ranked_opt_in:s.target.checked}:n))}),e.jsx("span",{className:`relative inline-block h-6 w-11 rounded-full bg-white/15 transition-colors peer-checked:bg-brand-teal/70 \r
                                after:content-[''] after:absolute after:left-0.5 after:top-0.5 after:h-5 after:w-5 after:rounded-full after:bg-white after:shadow after:transition-transform after:duration-200 peer-checked:after:translate-x-5`}),e.jsx("span",{className:"text-xs text-white/90",children:"Opted in"})]})]})]}),e.jsx("button",{className:"px-3 py-2 rounded bg-white/10 border border-uconn-border sm:col-span-2",onClick:async()=>{await Et(t.id,t),c("Person updated")},children:"Save Changes"})]})]},t.id))})]})]})}),p==="projects"&&e.jsxs("div",{role:"tabpanel",className:"mt-4 space-y-6",children:[e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("section",{className:"space-y-2",children:[e.jsx("h2",{className:"font-semibold",children:"Create Project & Assign Owners"}),e.jsxs("div",{className:"form-section p-4 space-y-3",children:[e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"Project name",value:V,onChange:t=>pe(t.target.value)}),e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"Design link (optional)",value:be,onChange:t=>je(t.target.value)}),e.jsx("textarea",{className:"px-3 py-2 rounded w-full",placeholder:"Project description (optional)",value:ge,onChange:t=>fe(t.target.value)}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("select",{className:"px-3 py-2 rounded w-full dark-select",value:ye,onChange:t=>Ne(t.target.value),children:[e.jsx("option",{value:"",children:"Select subsystem…"}),e.jsx("option",{children:"Aero"}),e.jsx("option",{children:"Business"}),e.jsx("option",{children:"Composites"}),e.jsx("option",{children:"Controls"}),e.jsx("option",{children:"Data Acquisition"}),e.jsx("option",{children:"Electrical IC"}),e.jsx("option",{children:"Electrical EV"}),e.jsx("option",{children:"Finance"}),e.jsx("option",{children:"Frame"}),e.jsx("option",{children:"Manufacturing"}),e.jsx("option",{children:"Powertrain EV"}),e.jsx("option",{children:"Powertrain IC"}),e.jsx("option",{children:"Suspension"})]}),e.jsx("input",{type:"date",className:"px-3 py-2 rounded w-full",value:we,onChange:t=>ve(t.target.value)})]}),e.jsx("div",{className:"text-sm text-uconn-muted",children:"Owners"}),e.jsx("input",{className:"px-3 py-2 rounded w-full mb-1",placeholder:"Search people…",value:$,onChange:t=>lt(t.target.value)}),e.jsx("div",{className:"grid sm:grid-cols-2 gap-2 max-h-48 overflow-auto border border-uconn-border rounded p-2",children:j.filter(t=>{if(!$.trim())return!0;const s=$.toLowerCase();return t.name.toLowerCase().includes(s)||(t.skills||[]).some(a=>a.toLowerCase().includes(s))}).map(t=>{var a;const s=he.includes(t.id);return e.jsxs("button",{onClick:()=>gt(t.id),className:"text-left px-2 py-1 rounded border "+(s?"bg-white/20":""),children:[e.jsx("div",{className:"font-medium text-sm",children:t.name}),e.jsx("div",{className:"text-xs text-uconn-muted",children:(a=t.skills)==null?void 0:a.join(", ")})]},t.id)})}),e.jsx("button",{onClick:yt,className:"px-3 py-2 rounded bg-white/10 border border-uconn-border",children:"Save Project"})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h2",{className:"font-semibold",children:"Create Task"}),e.jsxs("div",{className:"form-section p-4 space-y-3",children:[e.jsxs("select",{className:"px-3 py-2 rounded w-full dark-select",value:z,onChange:t=>Se(t.target.value),children:[e.jsx("option",{value:"",children:"Select project…"}),N.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"Task description",value:ke,onChange:t=>Ce(t.target.value)}),e.jsxs("select",{className:"px-3 py-2 rounded w-full dark-select",value:De,onChange:t=>Ae(t.target.value),children:[e.jsx("option",{value:"",children:"Assign to…"}),j.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:flex-wrap items-stretch gap-3",children:[e.jsxs("select",{className:"px-3 py-2 rounded dark-select h-11 sm:w-auto sm:min-w-[160px]",value:_e,onChange:t=>Pe(t.target.value),children:[e.jsx("option",{children:"Todo"}),e.jsx("option",{children:"In Progress"}),e.jsx("option",{children:"Complete"})]}),e.jsxs("select",{className:"px-3 py-2 rounded dark-select h-11 sm:w-auto sm:min-w-[200px]",value:Re,onChange:t=>Ee(t.target.value?Number(t.target.value):""),children:[e.jsx("option",{value:"",children:"Points (by estimated hours)"}),e.jsx("option",{value:"1",children:"1 pt ~ 30 mins"}),e.jsx("option",{value:"3",children:"3 pts ~ 1 hour"}),e.jsx("option",{value:"6",children:"6 pts ~ 2 hours"}),e.jsx("option",{value:"15",children:"15 pts ~ 5 hours"}),e.jsx("option",{value:"40",children:"40 pts ~ 10 hours"}),e.jsx("option",{value:"65",children:"65 pts ~ 15 hours"}),e.jsx("option",{value:"98",children:"98 pts ~ 20 hours"}),e.jsx("option",{value:"150",children:"150 pts ~ 25 hours"}),e.jsx("option",{value:"200",children:"200 pts ~ 30 hours"})]}),e.jsx("button",{onClick:Nt,className:"px-4 rounded bg-white/10 border border-uconn-border h-11 whitespace-nowrap sm:max-w-full",children:"Save Task"})]})]})]})]}),e.jsxs("section",{className:"mt-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2 relative",children:[e.jsx("h2",{className:"font-semibold mr-auto",children:"Projects"}),e.jsx("input",{className:"px-3 py-1.5 rounded-md text-xs font-medium border border-white/10 bg-white/5 w-56 placeholder:text-uconn-muted focus:outline-none focus-visible:outline-none",placeholder:"Search projects…",value:G,onChange:t=>ct(t.target.value)}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>{E(t=>!t),D(!1)},className:"px-3 py-1.5 rounded-md text-xs font-medium border border-white/10 bg-white/5 hover:bg-white/10",children:["Subsystems: ",e.jsx("span",{className:"font-semibold",children:P.length?`${P.length} selected`:"All"})]}),e.jsxs("div",{className:`absolute right-0 z-20 mt-1 w-64 rounded-md border border-white/10 bg-uconn-blue/95 shadow-xl overflow-hidden transition transform origin-top ${Me?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,children:[e.jsx("div",{className:"px-3 py-2 border-b border-white/10",children:e.jsx("button",{className:"w-full px-3 py-2 rounded-md text-xs sm:text-sm font-semibold bg-red-500/15 hover:bg-red-500/25 text-red-200 focus:outline-none focus-visible:outline-none",onClick:()=>Ie([]),children:"Clear selection"})}),e.jsxs("div",{className:"max-h-60 overflow-auto p-1",children:[Qe.length===0&&e.jsx("div",{className:"px-3 py-2 text-xs text-uconn-muted",children:"No subsystems"}),Qe.map(t=>{const s=P.includes(t),a=St.get(t)??0;return e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 text-xs rounded hover:bg-white/10 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"accent-brand-teal",checked:s,onChange:()=>Ie(n=>s?n.filter(o=>o!==t):[...n,t])}),e.jsx("span",{className:"truncate",children:t}),e.jsx("span",{className:"ml-auto inline-flex items-center justify-center rounded-full bg-white/10 px-2 py-0.5 text-[10px]",children:a})]},t)})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>{D(t=>!t),E(!1)},className:"px-3 py-1.5 rounded-md text-xs font-medium border border-white/10 bg-white/5 hover:bg-white/10",children:["Sort: ",e.jsxs("span",{className:"font-semibold",children:[et(k)," ",tt]})]}),e.jsx("div",{className:`absolute right-0 z-20 mt-1 w-48 rounded-md border border-white/10 bg-uconn-blue/95 shadow-xl overflow-hidden transition transform origin-top ${Oe?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,children:["subsystem","name","due"].map(t=>e.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs hover:bg-white/10 ${k===t?"bg-white/10":""}`,onClick:()=>{k===t?ut(s=>s==="asc"?"desc":"asc"):mt(t),D(!1)},children:[et(t)," ",k===t?tt:""]},t))})]}),(Me||Oe)&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>{E(!1),D(!1)}})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:kt.map(t=>e.jsxs("details",{className:"form-section p-3",children:[e.jsx("summary",{className:"cursor-pointer font-medium",children:t.name}),e.jsxs("div",{className:"mt-2 space-y-3",children:[e.jsx("input",{className:"px-3 py-2 rounded w-full",value:t.name,onChange:s=>x(a=>a.map(n=>n.id===t.id?{...n,name:s.target.value}:n))}),e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"Design link",value:t.design_link||"",onChange:s=>x(a=>a.map(n=>n.id===t.id?{...n,design_link:s.target.value}:n))}),e.jsx("textarea",{className:"px-3 py-2 rounded w-full",placeholder:"Description",value:t.description||"",onChange:s=>x(a=>a.map(n=>n.id===t.id?{...n,description:s.target.value}:n))}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("select",{className:"px-3 py-2 rounded w-full dark-select",value:t.subsystem||"",onChange:s=>x(a=>a.map(n=>n.id===t.id?{...n,subsystem:s.target.value||void 0}:n)),children:[e.jsx("option",{value:"",children:"Subsystem…"}),e.jsx("option",{children:"Aero"}),e.jsx("option",{children:"Business"}),e.jsx("option",{children:"Composites"}),e.jsx("option",{children:"Controls"}),e.jsx("option",{children:"Data Acquisition"}),e.jsx("option",{children:"Electrical IC"}),e.jsx("option",{children:"Electrical EV"}),e.jsx("option",{children:"Finance"}),e.jsx("option",{children:"Frame"}),e.jsx("option",{children:"Manufacturing"}),e.jsx("option",{children:"Powertrain EV"}),e.jsx("option",{children:"Powertrain IC"}),e.jsx("option",{children:"Suspension"})]}),e.jsx("input",{type:"date",className:"px-3 py-2 rounded w-full",value:t.due_date||"",onChange:s=>x(a=>a.map(n=>n.id===t.id?{...n,due_date:s.target.value}:n))})]}),e.jsx("button",{className:"px-3 py-2 rounded bg-white/10 border border-uconn-border w-full",onClick:async()=>{await Lt(t.id,t),c("Project updated")},children:"Save Changes"})]})]},t.id))})]})]}),p==="settings"&&e.jsxs("div",{role:"tabpanel",className:"mt-4",children:[e.jsxs("section",{className:"space-y-2",children:[e.jsx("h2",{className:"font-semibold",children:"Global Settings"}),e.jsxs("div",{className:"form-section wide p-4 space-y-2",children:[e.jsx("label",{className:"text-sm block",children:"Rulebook PDF URL"}),e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"https://…/rulebook.pdf",value:te,onChange:t=>B(t.target.value)}),e.jsx("label",{className:"text-sm block",children:"Team SharePoint URL"}),e.jsx("input",{className:"px-3 py-2 rounded w-full",placeholder:"https://…sharepoint.com/sites/FSAE/…",value:se,onChange:t=>U(t.target.value)}),e.jsx("button",{onClick:ft,className:"mt-2 px-3 py-2 rounded bg-white/10 border border-uconn-border",children:"Save Settings"})]}),e.jsxs("div",{className:"form-section wide p-4 mt-4 border border-red-500/30 bg-red-500/10 rounded-xl",children:[e.jsx("h3",{className:"font-semibold text-red-200",children:"Danger zone"}),e.jsx("p",{className:"text-sm text-red-200/80",children:"This will permanently delete ALL people, projects, and tasks. This action cannot be undone."}),e.jsxs("button",{onClick:()=>{Fe(""),T(!0)},className:"mt-3 inline-flex items-center gap-2 px-3 py-2 rounded border border-red-500/50 bg-red-600/20 hover:bg-red-600/30 text-red-100",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"3 6 5 6 21 6"}),e.jsx("path",{d:"M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),"Full system reset"]})]})]}),e.jsxs("section",{className:"space-y-2 mt-6",children:[e.jsx("h2",{className:"font-semibold",children:"Seed data (Excel)"}),e.jsxs("div",{className:"form-section wide p-4 space-y-3",children:[e.jsxs("p",{className:"text-sm text-uconn-muted",children:['Provide an Excel file with sheets named "People", "Projects", and "Tasks". Columns:',e.jsx("br",{}),"People: Name, Year, Role, Skills, Discord",e.jsx("br",{}),"Projects: Name, Subsystem, Due Date (YYYY-MM-DD), Description, Design Link, Owners (comma-separated names)",e.jsx("br",{}),"Tasks: Project, Description, Status (Todo|In Progress|Complete), Assignee (name)"]}),e.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:async t=>{var a;const s=(a=t.target.files)==null?void 0:a[0];if(s){Q(null),_("");try{const n=await s.arrayBuffer(),o=await b(()=>import("./xlsx-D_0l8YDs.js"),[]),i=o.read(n,{type:"array"}),d=i.Sheets.People,l=i.Sheets.Projects,u=i.Sheets.Tasks,Ct=d?o.utils.sheet_to_json(d):[],_t=l?o.utils.sheet_to_json(l):[],Pt=u?o.utils.sheet_to_json(u):[];Q({people:Ct.map(m=>{var f,w,v,y,A;return{name:((f=m.Name)==null?void 0:f.toString())||"",year:(w=m.Year)==null?void 0:w.toString(),role:(v=m.Role)==null?void 0:v.toString(),skills:(y=m.Skills)==null?void 0:y.toString(),discord:(A=m.Discord)==null?void 0:A.toString()}}),projects:_t.map(m=>{var f,w,v,y,A,st;return{name:((f=m.Name)==null?void 0:f.toString())||"",subsystem:(w=m.Subsystem)==null?void 0:w.toString(),due_date:(v=m["Due Date"])==null?void 0:v.toString(),description:(y=m.Description)==null?void 0:y.toString(),design_link:(A=m["Design Link"])==null?void 0:A.toString(),owners:(st=m.Owners)==null?void 0:st.toString()}}),tasks:Pt.map(m=>{var f,w,v,y;return{project:((f=m.Project)==null?void 0:f.toString())||"",description:((w=m.Description)==null?void 0:w.toString())||"",status:((v=m.Status)==null?void 0:v.toString())||"Todo",assignee:(y=m.Assignee)==null?void 0:y.toString()}})})}catch(n){console.error(n),_("Failed to read file")}}}}),g&&e.jsxs("div",{className:"text-sm",children:["Preview: ",g.people.length," people, ",g.projects.length," projects, ",g.tasks.length," tasks",e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{disabled:jt,className:"px-3 py-2 rounded border border-uconn-border bg-white/10 disabled:opacity-50",onClick:async()=>{var t,s;if(g){Je(!0),_("Importing…");try{const a=new Map;for(const o of j)a.set(o.name.trim(),o.id);for(const o of g.people){const i=(t=o.name)==null?void 0:t.trim();if(i&&!a.has(i)){const d=await at({name:i,year:o.year||void 0,role:o.role||void 0,skills:(o.skills||"").split(",").map(l=>l.trim()).filter(Boolean),discord:o.discord||void 0});a.set(i,d)}}const n=new Map;for(const o of g.projects){const i=(s=o.name)==null?void 0:s.trim();if(i&&!n.has(i)){const d=(o.owners||"").split(",").map(u=>u.trim()).filter(Boolean).map(u=>a.get(u)).filter(Boolean),l=await ot({name:i,subsystem:o.subsystem||void 0,due_date:o.due_date||void 0,description:o.description||void 0,design_link:o.design_link||void 0,owner_ids:d});n.set(i,l)}}for(const o of g.tasks){const i=n.get((o.project||"").trim());if(!i)continue;const d=o.assignee?a.get(o.assignee.trim()):void 0,l=o.status==="Todo"||o.status==="In Progress"||o.status==="Complete"?o.status:"Todo";await rt({project_id:i,description:o.description||"",status:l,assignee_id:d})}h(await O()),x(await Z()),_("Import complete")}catch(a){console.error(a),_("Import failed")}finally{Je(!1)}}},children:"Import"}),e.jsx("button",{className:"px-3 py-2 rounded border border-uconn-border bg-white/10",onClick:()=>{Q(null),_("")},children:"Clear"})]}),Xe&&e.jsx("div",{className:"mt-2 text-xs text-uconn-muted",children:Xe})]})]})]}),pt&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70",onClick:()=>T(!1)}),e.jsxs("div",{className:"relative w-[95vw] max-w-md rounded-xl border border-white/15 bg-uconn-blue/95 shadow-2xl p-5",children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Confirm full system reset"}),e.jsx("p",{className:"text-sm text-uconn-muted",children:"Enter the reset password to proceed. Contact the team lead if you don’t know it."}),e.jsxs("div",{className:"mt-3 relative",children:[e.jsx("input",{autoFocus:!0,type:Be?"text":"password",className:"w-full px-3 py-2 pr-10 rounded border border-white/10 bg-black/20",placeholder:"Reset password",value:W,onChange:t=>Fe(t.target.value)}),e.jsx("button",{"aria-label":"Toggle password visibility",onClick:()=>ht(t=>!t),className:"absolute right-1 top-1.5 h-7 w-7 inline-flex items-center justify-center rounded hover:bg-white/10",children:Be?e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#E5E7EB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 20C7 20 2.73 16.11 1 12c.6-1.36 1.5-2.59 2.57-3.61M10.58 5.06A10.94 10.94 0 0 1 12 4c5 0 9.27 3.89 11 8-."})}):e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#E5E7EB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>T(!1),className:"px-3 py-2 rounded border border-uconn-border bg-white/10",children:"Cancel"}),e.jsx("button",{onClick:async()=>{await wt(),T(!1)},disabled:W!=="UCONN FORMULA SAE",className:`px-3 py-2 rounded border ${W==="UCONN FORMULA SAE"?"border-red-500 bg-red-600/30 hover:bg-red-600/40 text-red-100":"border-white/10 bg-white/5 text-uconn-muted cursor-not-allowed"}`,children:"Permanently delete everything"})]})]})]})]}),p==="ranked"&&e.jsx("div",{role:"tabpanel",className:"mt-4",children:e.jsxs("section",{className:"space-y-2",children:[e.jsx("h2",{className:"font-semibold",children:"Ranked Settings"}),e.jsxs("div",{className:"form-section wide p-5 space-y-4",children:[e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"accent-brand-teal",checked:!!(C!=null&&C.enabled),onChange:async t=>{const s=t.target.checked;R(n=>n?{...n,enabled:s}:{enabled:s});const{setRankedSettings:a}=await b(async()=>{const{setRankedSettings:n}=await import("./index-DrAM74WJ.js").then(o=>o.D);return{setRankedSettings:n}},__vite__mapDeps([0,1]));await a({enabled:s})}}),"Enable ranked mode"]}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"accent-brand-teal",checked:!!(C!=null&&C.autoApply),onChange:async t=>{const s=t.target.checked;R(n=>n?{...n,autoApply:s}:{autoApply:s});const{setRankedSettings:a}=await b(async()=>{const{setRankedSettings:n}=await import("./index-DrAM74WJ.js").then(o=>o.D);return{setRankedSettings:n}},__vite__mapDeps([0,1]));await a({autoApply:s})}}),"Auto apply hourly"]})]}),e.jsxs("div",{className:"grid sm:grid-cols-2 gap-3 -mt-2",children:[e.jsx("p",{className:"text-xs text-uconn-muted",children:"When on, the app reveals the Ranked page and point indicators. Turning it off hides ranked UI and points, but nothing is deleted."}),e.jsx("p",{className:"text-xs text-uconn-muted",children:"When on, promotions/relegations can be applied on a schedule. In this client-only build it’s a manual action or conceptual; see note below."})]}),e.jsx("div",{className:"mt-2 overflow-auto rounded border border-white/10",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-white/5",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Rank"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Promote %"}),e.jsx("th",{className:"text-left px-3 py-2 font-medium",children:"Relegate %"})]})}),e.jsx("tbody",{children:["Bronze","Silver","Gold","Platinum","Diamond"].map(t=>{const s=t.toLowerCase(),a=X[s]??0,n=H[s]??0,o=t==="Diamond",i=t==="Bronze";return e.jsxs("tr",{className:"border-t border-white/10",children:[e.jsx("td",{className:"px-3 py-2 text-xs",children:t}),e.jsx("td",{className:"px-3 py-2",children:o?e.jsx("span",{className:"text-xs text-uconn-muted",children:"N/A"}):e.jsx("input",{type:"number",min:0,max:100,value:a,onChange:async d=>{const l=Math.max(0,Math.min(100,Number(d.target.value)));Ge(u=>({...u||{},[s]:l})),I(!0)},className:"px-2 py-1 rounded w-24 bg-white/5 border border-white/10"})}),e.jsx("td",{className:"px-3 py-2",children:i?e.jsx("span",{className:"text-xs text-uconn-muted",children:"N/A"}):e.jsx("input",{type:"number",min:0,max:100,value:n,onChange:async d=>{const l=Math.max(0,Math.min(100,Number(d.target.value)));qe(u=>({...u||{},[s]:l})),I(!0)},className:"px-2 py-1 rounded w-24 bg-white/5 border border-white/10"})})]},t)})})]})}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{disabled:!xt,onClick:async()=>{try{const{setRankedSettings:t}=await b(async()=>{const{setRankedSettings:s}=await import("./index-DrAM74WJ.js").then(a=>a.D);return{setRankedSettings:s}},__vite__mapDeps([0,1]));await t({promotion_pct:X,demotion_pct:H}),R(s=>({...s||{},promotion_pct:{...X},demotion_pct:{...H}})),I(!1),c("Ranked settings saved")}catch(t){console.error(t),c("Save failed")}},className:"mt-2 px-3 py-2 rounded bg-white/10 border border-uconn-border text-sm disabled:opacity-50",children:"Save changes"})}),e.jsx("div",{className:"pt-4 mt-2 border-t border-white/10",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"Manual override"}),e.jsx("p",{className:"text-xs text-uconn-muted",children:"Apply promotions and relegations immediately using the current week’s points."})]}),e.jsx("button",{disabled:Ue,onClick:()=>{We(""),M(!0)},className:"px-3 py-2 rounded bg-brand-teal/40 hover:bg-brand-teal/60 border border-uconn-border text-sm font-medium disabled:opacity-50",children:"Apply now"})]})}),e.jsxs("div",{className:"pt-4 mt-4 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Recent ranked activity"}),e.jsx("button",{className:"text-xs px-2 py-1 rounded border border-uconn-border bg-white/5",onClick:async()=>{const{fetchRecentLogs:t}=await b(async()=>{const{fetchRecentLogs:s}=await import("./index-DrAM74WJ.js").then(a=>a.D);return{fetchRecentLogs:s}},__vite__mapDeps([0,1]));J(await t(50))},children:"Refresh"})]}),e.jsxs("ul",{className:"text-sm divide-y divide-white/10 rounded border border-white/10",children:[$e.length===0&&e.jsx("li",{className:"px-3 py-2 text-uconn-muted",children:"No activity yet"}),$e.map((t,s)=>{var a,n,o;return e.jsxs("li",{className:"px-3 py-2 flex items-start gap-3",children:[e.jsx("span",{className:"text-xs text-uconn-muted w-40 shrink-0",children:new Date(t.ts||0).toLocaleString()}),e.jsx("span",{className:"font-mono text-xs uppercase tracking-wide px-1.5 py-0.5 rounded bg-white/10 border border-white/10",children:t.type}),e.jsxs("span",{className:"text-sm",children:[t.type==="attendance"&&e.jsxs(e.Fragment,{children:["Attendance · ",t.points," pts ",t.person_id?`→ ${((a=j.find(i=>i.id===t.person_id))==null?void 0:a.name)||t.person_id}`:""]}),t.type==="rank_change"&&e.jsxs(e.Fragment,{children:["Rank · ",((n=j.find(i=>i.id===t.person_id))==null?void 0:n.name)||t.person_id," ",t.from_rank," → ",t.to_rank]}),t.type==="task_points"&&e.jsxs(e.Fragment,{children:["Task · ",t.points," pts ",t.person_id?`→ ${((o=j.find(i=>i.id===t.person_id))==null?void 0:o.name)||t.person_id}`:""," ",t.note?`· ${t.note}`:""]}),t.type!=="attendance"&&t.type!=="rank_change"&&(t.note||"")]})]},t.id||s)})]})]})]})]})}),bt&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70",onClick:()=>M(!1)}),e.jsxs("div",{className:"relative w-[95vw] max-w-md rounded-xl border border-white/15 bg-uconn-blue/95 shadow-2xl p-5",children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Confirm ranked apply"}),e.jsx("p",{className:"text-sm text-uconn-muted",children:"Enter the confirmation phrase to proceed."}),e.jsx("input",{autoFocus:!0,className:"mt-3 w-full px-3 py-2 rounded border border-white/10 bg-black/20",placeholder:"Enter confirmation phrase",value:K,onChange:t=>We(t.target.value)}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>M(!1),className:"px-3 py-2 rounded border border-uconn-border bg-white/10",children:"Cancel"}),e.jsx("button",{disabled:K!=="UCONN FORMULA SAE"||Ue,className:`px-3 py-2 rounded border ${K==="UCONN FORMULA SAE"?"border-brand-teal bg-brand-teal/30 hover:bg-brand-teal/40 text-white":"border-white/10 bg-white/5 text-uconn-muted cursor-not-allowed"}`,onClick:async()=>{try{Ve(!0);const[t,s,a,n]=await Promise.all([O(),Tt(),It(),(await b(async()=>{const{fetchAttendance:d}=await import("./index-DrAM74WJ.js").then(l=>l.D);return{fetchAttendance:d}},__vite__mapDeps([0,1]))).fetchAttendance()]),o=await Mt(t,s,a,n);c(`${o} updates applied`);const{fetchRecentLogs:i}=await b(async()=>{const{fetchRecentLogs:d}=await import("./index-DrAM74WJ.js").then(l=>l.D);return{fetchRecentLogs:d}},__vite__mapDeps([0,1]));J(await i(50)),M(!1)}catch(t){console.error(t),c("Apply failed")}finally{Ve(!1)}},children:"Apply"})]})]})]})]}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Admin"}),e.jsx("p",{className:"text-sm text-uconn-muted mt-2",children:"You must be signed in as admin to access this page."})]})}export{Ut as default};
