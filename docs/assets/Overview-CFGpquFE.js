import{j as e,u as V,L as W,r as o,f as Y,a as I,b as q,c as J,d as Q}from"./index-B-YBCRUe.js";import{P as F}from"./ProgressBar-B9dtdoA-.js";import{R as Z,L as ee,C as se,X as te,Y as ne,T as re,A as ae,a as oe}from"./LineChart-CASGGAIb.js";function le({href:a,children:b}){return a?e.jsx("a",{href:a,target:"_blank",rel:"noreferrer",className:"inline-flex items-center px-3 py-1.5 rounded bg-white/10 hover:bg-white/20 transition",children:b}):null}function ie({project:a,owners:b,tasks:m,compact:g=!1}){const[w]=V(),h=m.length,c=m.filter(i=>i.status==="Complete").length,D=h>0?c/h*100:0,f=`${Math.round(D)}%`,y=h===0?"none":c===0?"todo":c===h?"done":"progress",l=y==="done"?"bg-green-500":y==="progress"?"bg-yellow-400":"bg-gray-400",M=m.reduce((i,p)=>i+(p.ranked_points??(p.status==="Complete"?35:10)),0),L=g?"rounded-xl bg-white/5 border border-white/10 p-2.5 space-y-2":"rounded-2xl bg-white/5 border border-white/10 p-3 space-y-2.5",$=g?"text-base font-semibold hover:underline":"text-lg font-semibold hover:underline",C=g?"h-2":"h-2.5";return e.jsxs("div",{className:L,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l}`,"aria-hidden":!0}),e.jsx(W,{to:`/project/${a.id}`,className:`${$} truncate`,title:a.name,children:a.name})]}),a.design_link&&e.jsx("div",{className:"flex gap-2 shrink-0",children:g?e.jsx("a",{href:a.design_link,target:"_blank",rel:"noreferrer",className:"inline-flex items-center h-7 px-2 rounded bg-brand-blue/40 hover:bg-brand-blue/60 text-[11px] font-medium",children:"Docs"}):e.jsx(le,{href:a.design_link,children:"Design Docs"})})]}),a.subsystem&&e.jsx("div",{className:"text-[10px] uppercase tracking-wide font-medium text-brand-teal/70",children:a.subsystem}),e.jsxs("div",{className:"flex items-start justify-between gap-2 text-[11px] text-uconn-muted",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-wide opacity-80 mb-1",children:"Owners"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:b.length?b.map(i=>e.jsx("span",{className:"px-1.5 py-0.5 rounded bg-white/10 whitespace-normal break-words",children:i.name},i.id)):e.jsx("span",{className:"opacity-60",children:"—"})})]}),a.due_date&&(()=>{let i=null;const p=a.due_date,j=p.match(/(\d{4})[\/-]?(\d{2})[\/-]?(\d{2})/);if(j){const[,v,T,N]=j;i=new Date(Number(v),Number(T)-1,Number(N))}else isNaN(Date.parse(p))||(i=new Date(p));if(i){const v=i.toLocaleString("en-US",{weekday:g?"short":"long"}),T=i.toLocaleString("en-US",{month:g?"short":"long"}),N=i.getDate(),E=n=>n===1||n===21||n===31?"st":n===2||n===22?"nd":n===3||n===23?"rd":"th";return e.jsxs("span",{className:"whitespace-nowrap ml-2 shrink-0",children:["Due ",v," ",T," ",N,E(N)]})}return null})()]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mt-1",children:[e.jsx("div",{className:"text-[11px] font-semibold",children:f}),e.jsxs("div",{className:"text-[10px] text-uconn-muted flex items-center gap-2",children:[e.jsx("span",{children:h>0?`${c}/${h} tasks`:"No tasks"}),w&&e.jsx("span",{className:"opacity-80",children:"·"}),w&&e.jsxs("span",{className:"font-semibold text-[10px]",children:["Σ +",M]})]})]}),e.jsx(F,{value:D,heightClass:C})]})}function ce({className:a="w-5 h-5 text-yellow-500 inline ml-1"}){return e.jsx("svg",{className:a,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6 2a1 1 0 00-1 1v2a1 1 0 001 1h8a1 1 0 001-1V3a1 1 0 00-1-1H6zm8 4H6v1a6 6 0 005 5.92V15H9a1 1 0 000 2h2a1 1 0 000-2h-2v-2.08A6 6 0 0014 7V6z"})})}function de({children:a,slideIndexInitial:b=0,onIndexChange:m,dots:g=!0,frameClassName:w}){const h=Array.isArray(a)?a:[a],[c,D]=o.useState(b),f=o.useRef(null),y=o.useRef(null),l=o.useRef({startX:0,currentX:0,dragging:!1,width:0});o.useEffect(()=>{m==null||m(c)},[c]);const M=(n,d=!0)=>{const u=y.current,A=f.current;if(!u||!A)return;const _=u.clientWidth;l.current.width=_,A.style.transition=d?"transform 320ms cubic-bezier(0.22, 1, 0.36, 1)":"none",A.style.transform=`translateX(${-n*_}px)`},L=n=>{const d=y.current;d&&(l.current={startX:n,currentX:n,dragging:!0,width:d.clientWidth})},$=n=>{if(!l.current.dragging)return;l.current.currentX=n;const d=n-l.current.startX,u=f.current;u&&(u.style.transition="none",u.style.transform=`translateX(${d-c*l.current.width}px)`)},C=()=>{if(!l.current.dragging)return;const n=l.current.currentX-l.current.startX,d=Math.max(40,l.current.width*.2);let u=c;n>d?u=Math.max(0,c-1):n<-d&&(u=Math.min(h.length-1,c+1)),M(u,!0),D(u),l.current.dragging=!1},i=n=>L(n.touches[0].clientX),p=n=>$(n.touches[0].clientX),j=()=>C(),v=n=>{n.preventDefault(),L(n.clientX)},T=n=>$(n.clientX),N=()=>C(),E=()=>C();return o.useEffect(()=>{const n=()=>{M(c,!1)};return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[c]),o.useEffect(()=>{M(c,!0)},[c]),e.jsx("div",{className:"w-full select-none",children:e.jsxs("div",{ref:y,className:`relative overflow-hidden rounded-2xl ${w||""}`,onTouchStart:i,onTouchMove:p,onTouchEnd:j,onMouseDown:v,onMouseMove:T,onMouseUp:N,onMouseLeave:E,children:[e.jsx("div",{ref:f,className:"flex",style:{willChange:"transform"},children:h.map((n,d)=>e.jsx("div",{className:"w-full shrink-0 px-1",children:n},d))}),g&&e.jsx("div",{className:"mt-3 mb-2 flex items-center justify-center gap-2",children:h.map((n,d)=>e.jsx("button",{"aria-label":`Show slide ${d+1}`,className:`w-2.5 h-2.5 rounded-full transition ${c===d?"bg-white":"bg-white/30 hover:bg-white/60"}`,onClick:()=>D(d)},d))})]})})}function z({label:a,value:b}){return e.jsxs("div",{className:"rounded-xl bg-white/5 border border-white/10 p-3 text-center flex flex-col items-center justify-center min-w-0",children:[e.jsx("div",{className:"text-xl font-semibold leading-tight",children:b}),e.jsx("div",{className:"text-[10px] sm:text-[11px] mt-1 tracking-wide text-uconn-muted uppercase whitespace-nowrap overflow-hidden text-ellipsis leading-snug",title:a,children:a})]})}function fe(){const[a,b]=o.useState([]),[m,g]=o.useState([]),[w,h]=o.useState([]),[c,D]=o.useState([]),[f,y]=o.useState([]),[l,M]=o.useState("subsystem"),[L,$]=o.useState("asc"),[C,i]=o.useState(!1),[p,j]=o.useState(!1);o.useEffect(()=>{(async()=>{const[s,t,r,x]=await Promise.all([Y(),I(),q(),J()]);b(s),g(t),h(r),D(x)})()},[]);const v=w.length,T=w.filter(s=>s.status==="Complete").length,N=v?Math.round(T/v*100):0;[...o.useMemo(()=>{const s=new Map;for(const t of m)for(const r of t.owner_ids||[])s.set(r,(s.get(r)||0)+1);return s},[m]).entries()].sort((s,t)=>t[1]-s[1]).slice(0,5).map(([s,t])=>{var r;return{name:((r=a.find(x=>x.id===s))==null?void 0:r.name)||s,count:t}});const n=a.map(s=>{const t=w.filter(r=>r.assignee_id===s.id&&r.status==="Complete").length;return{...s,completed:t}}).sort((s,t)=>t.completed-s.completed).slice(0,5),d=new Map(a.map(s=>[s.id,s])),u=new Map;for(const s of w){const t=u.get(s.project_id)??[];t.push(s),u.set(s.project_id,t)}const A=s=>{const t=u.get(s.id)??[];return t.length?t.filter(x=>x.status==="Complete").length/t.length:0};Q();const _=o.useMemo(()=>{const t=new Date,r=new Map;for(const P of c){const S=P.date;r.set(S,(r.get(S)||0)+1)}const x=P=>String(P).padStart(2,"0"),k=[];for(let P=20;P>=0;P--){const S=new Date(t);S.setDate(t.getDate()-P);const X=S.getDay();if(!(X===2||X===4||X===6))continue;const K=`${S.getFullYear()}-${x(S.getMonth()+1)}-${x(S.getDate())}`,U=S.toLocaleDateString("en-US",{month:"short",day:"numeric"});k.push({date:U,count:r.get(K)||0})}return k},[c]),R=o.useMemo(()=>{const s=new Set;for(const t of m)t.subsystem&&s.add(t.subsystem);return Array.from(s).sort()},[m]),G=o.useMemo(()=>{const s=new Map;for(const t of m)t.subsystem&&s.set(t.subsystem,(s.get(t.subsystem)||0)+1);return s},[m]),H=[...f.length?m.filter(s=>s.subsystem&&f.includes(s.subsystem)):m].sort((s,t)=>{let r=0;if(l==="name")r=s.name.localeCompare(t.name);else if(l==="due"){const x=s.due_date,k=t.due_date;x&&k?r=x.localeCompare(k):x&&!k?r=-1:!x&&k?r=1:r=0}else l==="progress"?r=A(s)-A(t):r=(s.subsystem||"").localeCompare(t.subsystem||"")||s.name.localeCompare(t.name);return L==="asc"?r:-r}),B=s=>s==="name"?"Name":s==="due"?"Due date":s==="progress"?"Progress":"Subsystem",O=L==="asc"?"↑":"↓";return o.useEffect(()=>{const s=t=>{t.key==="Escape"&&(i(!1),j(!1))};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[]),e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Team Overview"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mb-6",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsx(z,{label:"Total People",value:a.length}),e.jsx(z,{label:"Total Projects",value:m.length}),e.jsx(z,{label:"Total Tasks",value:v})]}),e.jsxs("div",{className:"rounded-xl bg-white/5 border border-white/10 p-4 pb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-[10px] sm:text-[11px] tracking-wide text-uconn-muted uppercase",children:"Total Task Completion"}),e.jsxs("div",{className:"text-xl font-semibold leading-tight",children:[N,"%"]})]}),e.jsx(F,{value:N,heightClass:"h-3"})]})]}),e.jsx("div",{className:"min-w-0",children:e.jsxs(de,{slideIndexInitial:0,onIndexChange:()=>{},dots:!0,children:[e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-3 md:p-4",children:[e.jsx("h2",{className:"text-base md:text-lg font-bold mb-2",children:"Meeting Attendance"}),e.jsx("div",{className:"h-48 sm:h-56",children:_.length?e.jsx(Z,{width:"100%",height:"100%",children:e.jsxs(ee,{data:_,margin:{top:10,right:10,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"attLine",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9"}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8"})]}),e.jsxs("linearGradient",{id:"attFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9",stopOpacity:.35}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8",stopOpacity:.05})]})]}),e.jsx(se,{stroke:"rgba(255,255,255,0.08)",strokeDasharray:"3 3"}),e.jsx(te,{dataKey:"date",tick:{fill:"#9CA3AF",fontSize:10},axisLine:!1,tickLine:!1}),e.jsx(ne,{allowDecimals:!1,tick:{fill:"#9CA3AF",fontSize:10},axisLine:!1,tickLine:!1,width:24}),e.jsx(re,{contentStyle:{background:"#0b132b",border:"1px solid rgba(255,255,255,0.1)",borderRadius:8},labelStyle:{color:"#cbd5e1"}}),e.jsx(ae,{type:"monotone",dataKey:"count",stroke:"none",fill:"url(#attFill)"}),e.jsx(oe,{type:"monotone",dataKey:"count",stroke:"url(#attLine)",strokeWidth:3,dot:{r:2,stroke:"#98D7D8"},activeDot:{r:4}})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-sm text-uconn-muted",children:"No attendance yet"})})]}),e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-3 md:p-4",children:[e.jsx("h2",{className:"text-base md:text-lg font-bold mb-2",children:"Leaderboard"}),e.jsx("div",{className:"h-48 sm:h-56 overflow-hidden",children:e.jsxs("table",{className:"w-full table-fixed text-xs sm:text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-8 py-1.5 px-2 text-center text-uconn-muted font-semibold",children:"#"}),e.jsx("th",{className:"py-1.5 px-2 text-left text-uconn-muted font-semibold",children:"Name"}),e.jsx("th",{className:"w-24 md:w-28 py-1.5 px-2 text-center text-uconn-muted font-semibold",children:"Completed"})]})}),e.jsx("tbody",{className:"align-middle",children:n.map((s,t)=>e.jsxs("tr",{className:t===0?"bg-yellow-100/40":"",children:[e.jsx("td",{className:"py-1.5 px-2 text-center",children:t+1}),e.jsx("td",{className:"py-1.5 px-2",children:e.jsxs("div",{className:"truncate flex items-center gap-1",children:[s.name,t===0&&e.jsx(ce,{})]})}),e.jsx("td",{className:"py-1.5 px-2 text-center",children:s.completed})]},s.id))})]})})]})]})})]}),e.jsx("h2",{className:"text-lg font-semibold mt-6 mb-2",children:"Projects"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-uconn-muted mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1",title:"Grey = To-do / Not started",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-400"})," To-do / Not started"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-400"})," In Progress"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Complete"]})]}),e.jsxs("div",{className:"relative flex flex-wrap items-center gap-2 mb-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>{i(s=>!s),j(!1)},className:"px-3 py-1.5 rounded-md text-xs font-medium border border-white/10 bg-white/5 hover:bg-white/10",children:["Subsystems: ",e.jsx("span",{className:"font-semibold",children:f.length?`${f.length} selected`:"All"})]}),e.jsxs("div",{className:`absolute z-20 mt-1 w-64 rounded-md border border-white/10 bg-uconn-blue/95 shadow-xl overflow-hidden transition transform origin-top ${C?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,children:[e.jsx("div",{className:"px-3 py-2 border-b border-white/10",children:e.jsx("button",{className:"w-full px-3 py-2 rounded-md text-xs sm:text-sm font-semibold bg-red-500/15 hover:bg-red-500/25 text-red-200 focus:outline-none focus-visible:outline-none",onClick:()=>y([]),children:"Clear selection"})}),e.jsxs("div",{className:"max-h-60 overflow-auto p-1",children:[R.length===0&&e.jsx("div",{className:"px-3 py-2 text-xs text-uconn-muted",children:"No subsystems"}),R.map(s=>{const t=f.includes(s),r=G.get(s)??0;return e.jsxs("label",{className:"flex items-center gap-2 px-2 py-1.5 text-xs rounded hover:bg-white/10 cursor-pointer focus:outline-none focus-visible:outline-none",children:[e.jsx("input",{type:"checkbox",className:"accent-brand-teal focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0",checked:t,onChange:()=>{y(x=>t?x.filter(k=>k!==s):[...x,s])}}),e.jsx("span",{className:"truncate",children:s}),e.jsx("span",{className:"ml-auto inline-flex items-center justify-center rounded-full bg-white/10 px-2 py-0.5 text-[10px]",children:r})]},s)})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>{j(s=>!s),i(!1)},className:"px-3 py-1.5 rounded-md text-xs font-medium border border-white/10 bg-white/5 hover:bg-white/10",children:["Sort: ",e.jsxs("span",{className:"font-semibold",children:[B(l)," ",O]})]}),e.jsx("div",{className:`absolute z-20 mt-1 w-48 rounded-md border border-white/10 bg-uconn-blue/95 shadow-xl overflow-hidden transition transform origin-top ${p?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,children:["subsystem","name","due","progress"].map(s=>e.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs hover:bg-white/10 ${l===s?"bg-white/10":""}`,onClick:()=>{l===s?$(t=>t==="asc"?"desc":"asc"):M(s),j(!1)},children:[B(s)," ",l===s?O:""]},s))})]}),(C||p)&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>{i(!1),j(!1)}})]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2",children:H.map(s=>{var t;return e.jsx(ie,{project:s,owners:((t=s.owner_ids)==null?void 0:t.map(r=>d.get(r)).filter(Boolean))??[],tasks:u.get(s.id)??[],compact:!0},s.id)})})]})}export{fe as default};
