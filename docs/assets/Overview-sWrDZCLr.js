import{j as e,L as P,r as h,u as S,s as _}from"./index-DOL89XtO.js";import{fetchPeople as T,fetchProjects as $,fetchTasks as M}from"./firestore-CBdVKXmS.js";import{P as k}from"./ProgressBar-DZE7LDNC.js";function A({href:n,children:d}){return n?e.jsx("a",{href:n,target:"_blank",rel:"noreferrer",className:"inline-flex items-center px-3 py-1.5 rounded bg-white/10 hover:bg-white/20 transition",children:d}):null}function D({project:n,owners:d,tasks:o,compact:i=!1}){const l=o.length,c=o.filter(a=>a.status==="Complete").length,m=l>0?c/l*100:0,f=`${Math.round(m)}%`,u=l===0?"none":c===0?"todo":c===l?"done":"progress",w=u==="done"?"bg-green-500":u==="progress"?"bg-yellow-400":l===0?"bg-white/30":"bg-red-500",g=i?"rounded-xl bg-white/5 border border-white/10 p-2.5 space-y-2":"rounded-2xl bg-white/5 border border-white/10 p-3 space-y-2.5",y=i?"text-base font-semibold hover:underline":"text-lg font-semibold hover:underline",N=i?"h-2":"h-2.5";return e.jsxs("div",{className:g,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${w}`,"aria-hidden":!0}),e.jsx(P,{to:`/project/${n.id}`,className:`${y} truncate`,title:n.name,children:n.name})]}),n.design_link&&e.jsx("div",{className:"flex gap-2 shrink-0",children:i?e.jsx("a",{href:n.design_link,target:"_blank",rel:"noreferrer",className:"inline-flex items-center h-7 px-2 rounded bg-brand-blue/40 hover:bg-brand-blue/60 text-[11px] font-medium",children:"Docs"}):e.jsx(A,{href:n.design_link,children:"Design Docs"})})]}),n.subsystem&&e.jsx("div",{className:"text-[10px] uppercase tracking-wide font-medium text-brand-teal/70",children:n.subsystem}),e.jsxs("div",{className:"flex items-center justify-between gap-2 text-[11px] text-uconn-muted",children:[e.jsxs("span",{className:"truncate",children:["Owners: ",d.map(a=>a.name).join(", ")||"â€”"]}),n.due_date&&(()=>{let a=null;const x=n.due_date,j=x.match(/(\d{4})[\/-]?(\d{2})[\/-]?(\d{2})/);if(j){const[,b,p,s]=j;a=new Date(Number(b),Number(p)-1,Number(s))}else isNaN(Date.parse(x))||(a=new Date(x));if(a){const b=a.toLocaleString("en-US",{weekday:i?"short":"long"}),p=a.toLocaleString("en-US",{month:i?"short":"long"}),s=a.getDate(),t=r=>r===1||r===21||r===31?"st":r===2||r===22?"nd":r===3||r===23?"rd":"th";return e.jsxs("span",{className:"whitespace-nowrap ml-2",children:["Due ",b," ",p," ",s,t(s)]})}return null})()]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mt-1",children:[e.jsx("div",{className:"text-[11px] font-semibold",children:f}),e.jsx("div",{className:"text-[10px] text-uconn-muted",children:l>0?`${c}/${l} tasks`:"No tasks"})]}),e.jsx(k,{value:m,heightClass:N}),e.jsx("div",{className:"text-[10px] text-uconn-muted mt-1",children:l>0?`${c}/${l} tasks complete`:"No tasks yet"})]})}function L({className:n="w-5 h-5 text-yellow-500 inline ml-1"}){return e.jsx("svg",{className:n,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6 2a1 1 0 00-1 1v2a1 1 0 001 1h8a1 1 0 001-1V3a1 1 0 00-1-1H6zm8 4H6v1a6 6 0 005 5.92V15H9a1 1 0 000 2h2a1 1 0 000-2h-2v-2.08A6 6 0 0014 7V6z"})})}function v({label:n,value:d}){return e.jsxs("div",{className:"rounded-xl bg-white/5 border border-white/10 p-3 text-center flex flex-col items-center justify-center",children:[e.jsx("div",{className:"text-xl font-semibold leading-tight",children:d}),e.jsx("div",{className:"text-[11px] mt-1 tracking-wide text-uconn-muted uppercase",children:n})]})}function E(){const[n,d]=h.useState([]),[o,i]=h.useState([]),[l,c]=h.useState([]),[m,f]=h.useState("All");h.useEffect(()=>{(async()=>{const[s,t,r]=await Promise.all([T(),$(),M()]);d(s),i(t),c(r)})()},[]);const u=l.length,w=l.filter(s=>s.status==="Complete").length,g=u?Math.round(w/u*100):0;[...h.useMemo(()=>{const s=new Map;for(const t of o)for(const r of t.owner_ids||[])s.set(r,(s.get(r)||0)+1);return s},[o]).entries()].sort((s,t)=>t[1]-s[1]).slice(0,5).map(([s,t])=>{var r;return{name:((r=n.find(C=>C.id===s))==null?void 0:r.name)||s,count:t}});const N=n.map(s=>{const t=l.filter(r=>r.assignee_id===s.id&&r.status==="Complete").length;return{...s,completed:t}}).sort((s,t)=>t.completed-s.completed).slice(0,3),a=new Map(n.map(s=>[s.id,s])),x=new Map;for(const s of l){const t=x.get(s.project_id)??[];t.push(s),x.set(s.project_id,t)}const j=S(),b=h.useMemo(()=>{const s=new Set;for(const t of o)t.subsystem&&s.add(t.subsystem);return Array.from(s).sort()},[o]),p=m==="All"?o:o.filter(s=>s.subsystem===m);return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Overview"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsx(v,{label:"Total People",value:n.length}),e.jsx(v,{label:"Total Projects",value:o.length}),e.jsx(v,{label:"Total Tasks",value:u})]}),e.jsxs("div",{className:"rounded-xl bg-white/5 border border-white/10 p-3 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-xs text-uconn-muted",children:"Progress"}),e.jsxs("div",{className:"text-xs font-semibold",children:[g,"%"]})]}),e.jsx(k,{value:g,heightClass:"h-3"})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Leaderboard"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[320px] w-full text-xs sm:text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10 py-2 px-2 text-center text-uconn-muted font-semibold",children:"#"}),e.jsx("th",{className:"py-2 px-2 text-left text-uconn-muted font-semibold",children:"Name"}),e.jsx("th",{className:"w-28 py-2 px-2 text-center text-uconn-muted font-semibold",children:"Completed"})]})}),e.jsx("tbody",{children:N.map((s,t)=>e.jsxs("tr",{className:t===0?"bg-yellow-100/40":"",children:[e.jsx("td",{className:"py-2 px-2 text-center",children:t+1}),e.jsx("td",{className:"py-2 px-2",children:e.jsxs("div",{className:"truncate max-w-[180px] sm:max-w-[260px] flex items-center gap-1",children:[s.name,t===0&&e.jsx(L,{})]})}),e.jsx("td",{className:"py-2 px-2 text-center",children:s.completed})]},s.id))})]})})]})}),e.jsx("h2",{className:"text-lg font-semibold mt-6 mb-2",children:"Projects"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-uconn-muted mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"})," Todo"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-400"})," In Progress"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"})," Complete"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("button",{onClick:()=>f("All"),className:`px-3 py-1.5 rounded-full text-xs font-medium border ${m==="All"?"bg-brand-teal/30 border-brand-teal/60":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:"All"}),b.map(s=>e.jsx("button",{onClick:()=>f(s),className:`px-3 py-1.5 rounded-full text-xs font-medium border ${m===s?"bg-brand-teal/30 border-brand-teal/60":"border-white/10 bg-white/5 hover:bg-white/10"}`,children:s},s))]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-2",children:p.map(s=>{var t;return e.jsx(D,{project:s,owners:((t=s.owner_ids)==null?void 0:t.map(r=>a.get(r)).filter(Boolean))??[],tasks:x.get(s.id)??[],compact:!0},s.id)})}),!j&&e.jsx("div",{className:"flex justify-center mt-12",children:e.jsx("button",{onClick:_,className:"text-xs border px-3 py-2 rounded bg-brand-blue/30 hover:bg-brand-blue/50 transition",children:"Sign in"})})]})}export{E as default};
