import{d as $,r,u as A,f as C,a as R,b as U,e as z,j as e,L as B}from"./index-DrAM74WJ.js";function I(){const{id:d}=$(),[n,S]=r.useState(null),[y,P]=r.useState([]),[f,_]=r.useState([]),[p,D]=r.useState([]),[c,F]=r.useState(null),[b]=A();if(r.useEffect(()=>{(async()=>{const[s,t,a,o]=await Promise.all([C(),R(),U(),z()]),j=s.find(m=>m.id===d)||null;S(j),P(t),D(a),_(a.filter(m=>m.assignee_id===d)),F(o)})()},[d]),!n)return e.jsx("div",{className:"text-sm",children:"Loading…"});const g=y.filter(s=>{var t;return((t=s.owner_ids)==null?void 0:t.includes(d))||p.some(a=>a.project_id===s.id&&a.assignee_id===d)}),T=g.length,E=f.length,L=f.filter(s=>s.status!=="Complete").length;function h(s){const t="/fsae-dashboard/",a=(s||"Bronze").toLowerCase();return`${t}icons/rank-${a}.${a==="bronze"||a==="silver"?"png":"svg"}`}const k=(n.rank_history||[]).slice().sort((s,t)=>t.ts-s.ts);return e.jsxs("div",{className:"max-w-2xl mx-auto mt-6 space-y-6",children:[e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4 flex flex-col gap-1.5 relative",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xl font-semibold leading-tight truncate flex items-center gap-2",children:e.jsx("span",{className:"truncate",children:n.name})}),n.discord&&e.jsxs("div",{className:"text-xs text-uconn-muted leading-snug truncate",children:["@",n.discord.replace(/^@/,"")]}),e.jsx("div",{className:"text-xs text-uconn-muted leading-snug",children:n.year||n.role})]}),b&&n.rank&&e.jsx("img",{src:h(n.rank),alt:n.rank,className:"shrink-0 h-8 w-8 object-contain"})]}),n.skills&&n.skills.length>0&&e.jsxs("div",{className:"text-sm",children:["Skills: ",n.skills.join(", ")]}),e.jsxs("div",{className:"flex gap-4 mt-1",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:T}),e.jsx("div",{className:"text-xs text-uconn-muted",children:"Projects"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:E}),e.jsx("div",{className:"text-xs text-uconn-muted",children:"Tasks"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:L}),e.jsx("div",{className:"text-xs text-uconn-muted",children:"To Do"})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Quick Links"}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[(()=>{const s=(c==null?void 0:c.sharepoint_url)||"https://uconn-my.sharepoint.com/shared?id=%2Fsites%2FUConnFormulaSAE%2FShared%20Documents&listurl=https%3A%2F%2Fuconn%2Esharepoint%2Ecom%2Fsites%2FUConnFormulaSAE%2FShared%20Documents";return e.jsx("li",{children:e.jsx("a",{className:"underline",href:s,target:"_blank",children:"SharePoint"})})})(),(c==null?void 0:c.rulebook_url)&&e.jsx("li",{children:e.jsx("a",{className:"underline",href:c.rulebook_url,target:"_blank",children:"Rulebook (PDF)"})})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Projects"}),e.jsx("ul",{className:"space-y-3",children:g.map(s=>{const t=p.filter(l=>l.project_id===s.id),a=t.length,o=t.filter(l=>l.status==="Complete").length,j=a?Math.round(o/a*100):0,m=(()=>{const l=s.due_date||"",v=l.match(/(\d{4})[\/-]?(\d{2})[\/-]?(\d{2})/);let x=null;if(v){const[,N,u,w]=v;x=new Date(Number(N),Number(u)-1,Number(w))}else isNaN(Date.parse(l))||(x=new Date(l));if(x){const N=x.toLocaleString("en-US",{month:"long"}),u=x.getDate();return`${N} ${u}${(i=>i===1||i===21||i===31?"st":i===2||i===22?"nd":i===3||i===23?"rd":"th")(u)}`}return l})();return e.jsxs("li",{className:"rounded-xl bg-white/10 border border-white/10 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{className:"underline font-semibold",to:`/project/${s.id}`,children:s.name}),e.jsxs("div",{className:"text-xs text-uconn-muted",children:[o,"/",a," · ",j,"%"]})]}),e.jsxs("div",{className:"text-xs text-uconn-muted",children:[s.description||"—",s.due_date&&e.jsxs(e.Fragment,{children:[" · Due ",m]})]}),t.length>0&&e.jsx("ul",{className:"mt-2 list-disc pl-5 text-sm",children:t.map(l=>e.jsxs("li",{children:[l.description," ",e.jsxs("span",{className:"text-uconn-muted",children:["(",l.status,")"]})]},l.id))})]},s.id)})})]}),b&&e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Ranked History"}),k.length===0?e.jsx("div",{className:"text-xs text-uconn-muted",children:"No rank changes yet."}):e.jsx("ul",{className:"space-y-2 text-sm",children:k.map((s,t)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-uconn-muted w-28",children:new Date(s.ts).toLocaleDateString("en-US")}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:h(s.from),alt:s.from,className:"h-4 w-4 object-contain"}),e.jsx("span",{children:s.from})]}),e.jsx("span",{className:"text-uconn-muted",children:"→"}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:h(s.to),alt:s.to,className:"h-4 w-4 object-contain"}),e.jsx("span",{children:s.to})]})]},t))})]})]})}export{I as default};
