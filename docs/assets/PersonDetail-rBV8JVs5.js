import{d as $,r as d,f as U,a as B,b as I,e as M,j as e,L as z}from"./index-B7LHv9gh.js";function Q(){const{id:i}=$(),[n,S]=d.useState(null),[_,P]=d.useState([]),[g,D]=d.useState([]),[j,F]=d.useState([]),[r,T]=d.useState(null);if(d.useEffect(()=>{(async()=>{const[s,t,l,u]=await Promise.all([U(),B(),I(),M()]),N=s.find(o=>o.id===i)||null;S(N),P(t),F(l),D(l.filter(o=>o.assignee_id===i)),T(u)})()},[i]),!n)return e.jsx("div",{className:"text-sm",children:"Loading…"});const b=_.filter(s=>{var t;return((t=s.owner_ids)==null?void 0:t.includes(i))||j.some(l=>l.project_id===s.id&&l.assignee_id===i)}),C=b.length,E=g.length,L=g.filter(s=>s.status!=="Complete").length,x=new Map;for(const s of j)s.status==="Complete"&&s.assignee_id&&x.set(s.assignee_id,(x.get(s.assignee_id)||0)+1);const A=[...x.entries()].sort((s,t)=>t[1]-s[1]),k=i?A.findIndex(([s])=>s===i)+1:void 0,R=x.get(i||"")||0;function p(s){return`/icons/rank-${(s||"Bronze").toLowerCase()}.svg`}const v=(n.rank_history||[]).slice().sort((s,t)=>t.ts-s.ts);return e.jsxs("div",{className:"max-w-2xl mx-auto mt-6 space-y-6",children:[e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4 flex flex-col gap-1.5 relative",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-xl font-semibold leading-tight truncate flex items-center gap-2",children:[n.rank&&e.jsx("img",{src:p(n.rank),alt:n.rank,className:"h-5 w-5"}),e.jsx("span",{className:"truncate",children:n.name})]}),n.discord&&e.jsxs("div",{className:"text-xs text-uconn-muted leading-snug truncate",children:["@",n.discord.replace(/^@/,"")]}),e.jsx("div",{className:"text-xs text-uconn-muted leading-snug",children:n.year||n.role})]}),k?e.jsxs("div",{className:"shrink-0 flex flex-col items-end text-right",children:[e.jsx("div",{className:"text-[10px] tracking-wide text-uconn-muted uppercase",children:"Rank"}),e.jsxs("div",{className:"mt-0.5 px-2 py-1 rounded-md bg-gradient-to-r from-brand-teal/30 to-brand-lightTeal/30 border border-brand-teal/40 text-xs font-semibold",children:["#",k]}),e.jsxs("div",{className:"mt-1 text-[10px] text-uconn-muted",children:[R," done"]})]}):e.jsx("div",{className:"shrink-0 text-[10px] text-uconn-muted mt-1",children:"No rank yet"})]}),n.skills&&n.skills.length>0&&e.jsxs("div",{className:"text-sm",children:["Skills: ",n.skills.join(", ")]}),e.jsxs("div",{className:"flex gap-4 mt-1",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:C}),e.jsx("div",{className:"text-xs text-uconn-muted",children:"Projects"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:E}),e.jsx("div",{className:"text-xs text-uconn-muted",children:"Tasks"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:L}),e.jsx("div",{className:"text-xs text-uconn-muted",children:"To Do"})]})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Quick Links"}),e.jsxs("ul",{className:"list-disc pl-5 text-sm",children:[(()=>{const s=(r==null?void 0:r.sharepoint_url)||"https://uconn-my.sharepoint.com/shared?id=%2Fsites%2FUConnFormulaSAE%2FShared%20Documents&listurl=https%3A%2F%2Fuconn%2Esharepoint%2Ecom%2Fsites%2FUConnFormulaSAE%2FShared%20Documents";return e.jsx("li",{children:e.jsx("a",{className:"underline",href:s,target:"_blank",children:"SharePoint"})})})(),(r==null?void 0:r.rulebook_url)&&e.jsx("li",{children:e.jsx("a",{className:"underline",href:r.rulebook_url,target:"_blank",children:"Rulebook (PDF)"})})]})]}),e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Projects"}),e.jsx("ul",{className:"space-y-3",children:b.map(s=>{const t=j.filter(a=>a.project_id===s.id),l=t.length,u=t.filter(a=>a.status==="Complete").length,N=l?Math.round(u/l*100):0,o=(()=>{const a=s.due_date||"",w=a.match(/(\d{4})[\/-]?(\d{2})[\/-]?(\d{2})/);let m=null;if(w){const[,f,h,y]=w;m=new Date(Number(f),Number(h)-1,Number(y))}else isNaN(Date.parse(a))||(m=new Date(a));if(m){const f=m.toLocaleString("en-US",{month:"long"}),h=m.getDate();return`${f} ${h}${(c=>c===1||c===21||c===31?"st":c===2||c===22?"nd":c===3||c===23?"rd":"th")(h)}`}return a})();return e.jsxs("li",{className:"rounded-xl bg-white/10 border border-white/10 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{className:"underline font-semibold",to:`/project/${s.id}`,children:s.name}),e.jsxs("div",{className:"text-xs text-uconn-muted",children:[u,"/",l," · ",N,"%"]})]}),e.jsxs("div",{className:"text-xs text-uconn-muted",children:[s.description||"—",s.due_date&&e.jsxs(e.Fragment,{children:[" · Due ",o]})]}),t.length>0&&e.jsx("ul",{className:"mt-2 list-disc pl-5 text-sm",children:t.map(a=>e.jsxs("li",{children:[a.description," ",e.jsxs("span",{className:"text-uconn-muted",children:["(",a.status,")"]})]},a.id))})]},s.id)})})]}),e.jsxs("div",{className:"rounded-2xl bg-white/5 border border-white/10 p-4",children:[e.jsx("h2",{className:"font-semibold mb-2",children:"Ranked History"}),v.length===0?e.jsx("div",{className:"text-xs text-uconn-muted",children:"No rank changes yet."}):e.jsx("ul",{className:"space-y-2 text-sm",children:v.map((s,t)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-uconn-muted w-28",children:new Date(s.ts).toLocaleDateString("en-US")}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:p(s.from),alt:s.from,className:"h-4 w-4"}),e.jsx("span",{children:s.from})]}),e.jsx("span",{className:"text-uconn-muted",children:"→"}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:p(s.to),alt:s.to,className:"h-4 w-4"}),e.jsx("span",{children:s.to})]})]},t))})]})]})}export{Q as default};
