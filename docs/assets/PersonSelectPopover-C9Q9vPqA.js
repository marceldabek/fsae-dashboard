import{R as m,j as t,F as E,G as U,H as $,B as F,r as a}from"./index-DLcpZy5D.js";async function q(){const r=$(void 0,"us-central1"),s=(await F(r,"getAdminRoles")())?.data??{};if(typeof s.uid!="string"||typeof s.isAdmin!="boolean"||typeof s.isLead!="boolean"||!Array.isArray(s.adminUids)||!Array.isArray(s.leadUids))throw new Error("Roles function did not return the full shape");return{uid:s.uid,isAdmin:s.isAdmin,isLead:s.isLead,adminUids:s.adminUids,leadUids:s.leadUids,version:s.version}}let o=null;function y(r){return E(U,async i=>{if(!i){o=null,r(null);return}try{o=await q(),r(o)}catch{o={uid:i?.uid??"",isAdmin:!1,isLead:!1,adminUids:[],leadUids:[]},r(o)}})}function P({children:r}){const[i,l]=m.useState(o);return m.useEffect(()=>y(l),[]),i&&(i.isAdmin||i.isLead)?t.jsx(t.Fragment,{children:r}):null}function z({children:r}){const[i,l]=m.useState(o);return m.useEffect(()=>y(l),[]),i&&i.isAdmin?t.jsx(t.Fragment,{children:r}):null}function M(r){const{people:i,mode:l="single",selectedId:s=null,selectedIds:d=[],onSelect:w,onAdd:j,onRemove:k,triggerLabel:f,triggerContent:v,buttonClassName:N="px-3 py-2 rounded bg-white/10 border border-white/20 text-sm hover:bg-white/15 transition",disabled:x=!1,maxItems:u=8,allowUnassign:A=!0,allowScroll:L=!1}=r,[h,c]=a.useState(!1),[p,R]=a.useState(""),b=a.useRef(null);a.useEffect(()=>{function e(n){n.key==="Escape"&&c(!1)}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),a.useEffect(()=>{if(!h)return;function e(n){b.current&&!b.current.contains(n.target)&&c(!1)}return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)},[h]);const g=a.useMemo(()=>{const e=p.toLowerCase();return i.filter(n=>!e||n.name.toLowerCase().includes(e)||(n.skills||[]).join(" ").toLowerCase().includes(e))},[i,p]),S=a.useMemo(()=>new Set(d),[d]),C=(()=>{if(f)return f;if(l==="single"){if(s){const e=i.find(n=>n.id===s);return e?e.name:"Assign to…"}return"Assign to…"}if(d.length===0)return"Add/Remove";if(d.length===1){const e=i.find(n=>n.id===d[0]);return e?e.name:"1 selected"}return`${d.length} selected`})();return t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",disabled:x,onClick:()=>!x&&c(e=>!e),className:`${N} ${x?"opacity-50 cursor-not-allowed":""}`,"aria-label":typeof v<"u"?f||"Open selector":void 0,children:v??C}),h&&t.jsxs("div",{className:"fixed inset-0 z-40 flex items-start justify-center pt-24 px-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),t.jsxs("div",{ref:b,className:"relative z-10 w-full max-w-md rounded-lg border border-white/15 bg-black/80 p-3 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{autoFocus:!0,value:p,onChange:e=>R(e.target.value),placeholder:"Search people…",className:"w-full px-2 py-1.5 rounded bg-white/10 text-sm focus:outline-none"}),t.jsx("button",{onClick:()=>c(!1),className:"text-[11px] px-2 py-1 rounded bg-white/10 border border-white/20 hover:bg-white/15",children:"Close"})]}),t.jsxs("ul",{className:`space-y-1 text-sm ${L?"max-h-60 overflow-auto":""}`,children:[l==="single"&&A&&t.jsx("li",{children:t.jsx("button",{className:`w-full text-left px-2 py-1 rounded hover:bg-white/5 text-[13px] ${s?"":"bg-white/10"}`,onClick:()=>{w?.(null),c(!1)},children:"Unassigned"})}),g.slice(0,u).map(e=>{const n=l==="single"?e.id===s:S.has(e.id);return t.jsxs("li",{className:"flex items-center gap-2 justify-between px-2 py-1 rounded hover:bg-white/5",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"truncate text-sm font-medium",children:e.name}),e.skills&&e.skills.length>0&&t.jsx("div",{className:"text-xs text-muted truncate uppercase tracking-caps",children:e.skills.join(", ")})]}),l==="multi"?t.jsx("button",{onClick:()=>n?k?.(e.id):j?.(e.id),className:`px-2 py-1 rounded text-tick border ${n?"bg-accent/20 border-accent/40 text-accent":"bg-overlay-6 border-overlay-10 hover:bg-overlay-10/60"}`,children:n?"Remove":"Add"}):t.jsx("button",{onClick:()=>{w?.(e.id),c(!1)},className:`px-2 py-1 rounded text-tick border ${n?"bg-accent/30 border-accent/50 text-accent":"bg-overlay-6 border-overlay-10 hover:bg-overlay-10/60"}`,children:n?"Selected":"Select"})]},e.id)}),g.slice(0,u).length===0&&t.jsx("li",{className:"text-xs text-muted px-2 py-1 uppercase tracking-caps",children:"No people"}),g.length>u&&t.jsxs("li",{className:"text-tick text-muted px-2 py-1",children:["Showing first ",u," results… refine search"]})]})]})]})]})}export{M as P,P as R,z as a};
