import{r as n,j as t}from"./index-BzkRah2L.js";function L(h){const{people:o,mode:a="single",selectedId:c=null,selectedIds:r=[],onSelect:b,onAdd:v,onRemove:w,triggerLabel:d,triggerContent:g,buttonClassName:y="px-3 py-2 rounded bg-card/80 border border-white/20 text-sm hover:bg-card transition",disabled:u=!1,maxItems:i=8,allowUnassign:j=!0,allowScroll:k=!1}=h,[x,l]=n.useState(!1),[m,N]=n.useState(""),f=n.useRef(null);n.useEffect(()=>{function e(s){s.key==="Escape"&&l(!1)}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),n.useEffect(()=>{if(!x)return;function e(s){f.current&&!f.current.contains(s.target)&&l(!1)}return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)},[x]);const p=n.useMemo(()=>{const e=m.toLowerCase();return o.filter(s=>!e||s.name.toLowerCase().includes(e)||(s.skills||[]).join(" ").toLowerCase().includes(e))},[o,m]),C=n.useMemo(()=>new Set(r),[r]),S=(()=>{if(d)return d;if(a==="single"){if(c){const e=o.find(s=>s.id===c);return e?e.name:"Assign to…"}return"Assign to…"}if(r.length===0)return"Add/Remove";if(r.length===1){const e=o.find(s=>s.id===r[0]);return e?e.name:"1 selected"}return`${r.length} selected`})();return t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",disabled:u,onClick:()=>!u&&l(e=>!e),className:`${y} ${u?"opacity-50 cursor-not-allowed":""}`,"aria-label":typeof g<"u"?d||"Open selector":void 0,children:g??S}),x&&t.jsxs("div",{className:"fixed inset-0 z-40 flex items-start justify-center pt-24 px-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm"}),t.jsxs("div",{ref:f,className:"relative z-10 w-full max-w-md rounded-lg border border-white/15 bg-black/80 p-3 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{autoFocus:!0,value:m,onChange:e=>N(e.target.value),placeholder:"Search people…",className:"w-full px-2 py-1.5 rounded bg-card/80 text-sm focus:outline-none"}),t.jsx("button",{onClick:()=>l(!1),className:"text-[11px] px-2 py-1 rounded bg-card/80 border border-white/20 hover:bg-card",children:"Close"})]}),t.jsxs("ul",{className:`space-y-1 text-sm ${k?"max-h-60 overflow-auto":""}`,children:[a==="single"&&j&&t.jsx("li",{children:t.jsx("button",{className:`w-full text-left px-2 py-1 rounded hover:bg-card text-[13px] ${c?"":"bg-card/80"}`,onClick:()=>{b?.(null),l(!1)},children:"Unassigned"})}),p.slice(0,i).map(e=>{const s=a==="single"?e.id===c:C.has(e.id);return t.jsxs("li",{className:"flex items-center gap-2 justify-between px-2 py-1 rounded hover:bg-card",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"truncate text-sm font-medium",children:e.name}),e.skills&&e.skills.length>0&&t.jsx("div",{className:"text-xs text-muted truncate uppercase tracking-caps",children:e.skills.join(", ")})]}),a==="multi"?t.jsx("button",{onClick:()=>s?w?.(e.id):v?.(e.id),className:`px-2 py-1 rounded text-tick border ${s?"bg-accent/20 border-accent/40 text-accent":"bg-overlay-6 border-overlay-10 hover:bg-overlay-10/60"}`,children:s?"Remove":"Add"}):t.jsx("button",{onClick:()=>{b?.(e.id),l(!1)},className:`px-2 py-1 rounded text-tick border ${s?"bg-accent/30 border-accent/50 text-accent":"bg-overlay-6 border-overlay-10 hover:bg-overlay-10/60"}`,children:s?"Selected":"Select"})]},e.id)}),p.slice(0,i).length===0&&t.jsx("li",{className:"text-xs text-muted px-2 py-1 uppercase tracking-caps",children:"No people"}),p.length>i&&t.jsxs("li",{className:"text-tick text-muted px-2 py-1",children:["Showing first ",i," results… refine search"]})]})]})]})]})}export{L as P};
