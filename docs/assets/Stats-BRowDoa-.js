import{R as P,r as w,f as ht,a as yt,b as xt,c as gt,G as vt,j as e}from"./index-CDBOaIZ2.js";import{i as bt,c as ot,D as jt,f as kt,E as At,L as et,b as J,d as Dt,e as wt,g as X,h as St,j as rt,k as Ct,l as Pt,m as ut,u as Nt,G as Ot,n as it,o as _t,X as R,Y as K,p as Lt,R as G,C as U,T as H,q as nt,A as Tt,a as Et}from"./AreaChart-CPXpqakf.js";var Bt=["type","layout","connectNulls","ref"],Mt=["key"];function Y(t){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Y(t)}function lt(t,a){if(t==null)return{};var n=It(t,a),r,i;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(i=0;i<u.length;i++)r=u[i],!(a.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function It(t,a){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(a.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Z(){return Z=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Z.apply(this,arguments)}function ct(t,a){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function N(t){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?arguments[a]:{};a%2?ct(Object(n),!0).forEach(function(r){T(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function z(t){return Kt(t)||Rt(t)||$t(t)||Ft()}function Ft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $t(t,a){if(t){if(typeof t=="string")return at(t,a);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(t,a)}}function Rt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kt(t){if(Array.isArray(t))return at(t)}function at(t,a){(a==null||a>t.length)&&(a=t.length);for(var n=0,r=new Array(a);n<a;n++)r[n]=t[n];return r}function zt(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function dt(t,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ft(r.key),r)}}function Wt(t,a,n){return a&&dt(t.prototype,a),n&&dt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gt(t,a,n){return a=Q(a),Ut(t,pt()?Reflect.construct(a,n||[],Q(t).constructor):a.apply(t,n))}function Ut(t,a){if(a&&(Y(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ht(t)}function Ht(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pt=function(){return!!t})()}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Q(t)}function Vt(t,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(a&&a.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),a&&st(t,a)}function st(t,a){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},st(t,a)}function T(t,a,n){return a=ft(a),a in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t}function ft(t){var a=Yt(t,"string");return Y(a)=="symbol"?a:a+""}function Yt(t,a){if(Y(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,a);if(Y(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var B=(function(t){function a(){var n;zt(this,a);for(var r=arguments.length,i=new Array(r),u=0;u<r;u++)i[u]=arguments[u];return n=Gt(this,a,[].concat(i)),T(n,"state",{isAnimationFinished:!0,totalLength:0}),T(n,"generateSimpleStrokeDasharray",function(c,f){return"".concat(f,"px ").concat(c-f,"px")}),T(n,"getStrokeDasharray",function(c,f,p){var v=p.reduce(function(O,_){return O+_});if(!v)return n.generateSimpleStrokeDasharray(f,c);for(var j=Math.floor(c/v),D=c%v,b=f-c,k=[],g=0,A=0;g<p.length;A+=p[g],++g)if(A+p[g]>D){k=[].concat(z(p.slice(0,g)),[D-A]);break}var C=k.length%2===0?[0,b]:[b];return[].concat(z(a.repeat(p,j)),z(k),C).map(function(O){return"".concat(O,"px")}).join(", ")}),T(n,"id",Nt("recharts-line-")),T(n,"pathRef",function(c){n.mainCurve=c}),T(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),T(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Vt(a,t),Wt(a,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var u=this.props,c=u.points,f=u.xAxis,p=u.yAxis,v=u.layout,j=u.children,D=kt(j,At);if(!D)return null;var b=function(A,C){return{x:A.x,y:A.y,value:A.value,errorVal:ut(A.payload,C)}},k={clipPath:r?"url(#clipPath-".concat(i,")"):null};return P.createElement(et,k,D.map(function(g){return P.cloneElement(g,{key:"bar-".concat(g.props.dataKey),data:c,xAxis:f,yAxis:p,layout:v,dataPointFormatter:b})}))}},{key:"renderDots",value:function(r,i,u){var c=this.props.isAnimationActive;if(c&&!this.state.isAnimationFinished)return null;var f=this.props,p=f.dot,v=f.points,j=f.dataKey,D=J(this.props,!1),b=J(p,!0),k=v.map(function(A,C){var O=N(N(N({key:"dot-".concat(C),r:3},D),b),{},{index:C,cx:A.x,cy:A.y,value:A.value,dataKey:j,payload:A.payload,points:v});return a.renderDotItem(p,O)}),g={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(u,")"):null};return P.createElement(et,Z({className:"recharts-line-dots",key:"dots"},g),k)}},{key:"renderCurveStatically",value:function(r,i,u,c){var f=this.props,p=f.type,v=f.layout,j=f.connectNulls;f.ref;var D=lt(f,Bt),b=N(N(N({},J(D,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(u,")"):null,points:r},c),{},{type:p,layout:v,connectNulls:j});return P.createElement(Dt,Z({},b,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,i){var u=this,c=this.props,f=c.points,p=c.strokeDasharray,v=c.isAnimationActive,j=c.animationBegin,D=c.animationDuration,b=c.animationEasing,k=c.animationId,g=c.animateNewValues,A=c.width,C=c.height,O=this.state,_=O.prevPoints,M=O.totalLength;return P.createElement(wt,{begin:j,duration:D,isActive:v,easing:b,from:{t:0},to:{t:1},key:"line-".concat(k),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(I){var L=I.t;if(_){var s=_.length/f.length,d=f.map(function(y,F){var x=Math.floor(F*s);if(_[x]){var S=_[x],E=X(S.x,y.x),q=X(S.y,y.y);return N(N({},y),{},{x:E(L),y:q(L)})}if(g){var tt=X(A*2,y.x),mt=X(C/2,y.y);return N(N({},y),{},{x:tt(L),y:mt(L)})}return N(N({},y),{},{x:y.x,y:y.y})});return u.renderCurveStatically(d,r,i)}var o=X(0,M),l=o(L),m;if(p){var h="".concat(p).split(/[,\s]+/gim).map(function(y){return parseFloat(y)});m=u.getStrokeDasharray(l,M,h)}else m=u.generateSimpleStrokeDasharray(M,l);return u.renderCurveStatically(f,r,i,{strokeDasharray:m})})}},{key:"renderCurve",value:function(r,i){var u=this.props,c=u.points,f=u.isAnimationActive,p=this.state,v=p.prevPoints,j=p.totalLength;return f&&c&&c.length&&(!v&&j>0||!St(v,c))?this.renderCurveWithAnimation(r,i):this.renderCurveStatically(c,r,i)}},{key:"render",value:function(){var r,i=this.props,u=i.hide,c=i.dot,f=i.points,p=i.className,v=i.xAxis,j=i.yAxis,D=i.top,b=i.left,k=i.width,g=i.height,A=i.isAnimationActive,C=i.id;if(u||!f||!f.length)return null;var O=this.state.isAnimationFinished,_=f.length===1,M=ot("recharts-line",p),I=v&&v.allowDataOverflow,L=j&&j.allowDataOverflow,s=I||L,d=rt(C)?this.id:C,o=(r=J(c,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},l=o.r,m=l===void 0?3:l,h=o.strokeWidth,y=h===void 0?2:h,F=Ct(c)?c:{},x=F.clipDot,S=x===void 0?!0:x,E=m*2+y;return P.createElement(et,{className:M},I||L?P.createElement("defs",null,P.createElement("clipPath",{id:"clipPath-".concat(d)},P.createElement("rect",{x:I?b:b-k/2,y:L?D:D-g/2,width:I?k:k*2,height:L?g:g*2})),!S&&P.createElement("clipPath",{id:"clipPath-dots-".concat(d)},P.createElement("rect",{x:b-E/2,y:D-E/2,width:k+E,height:g+E}))):null,!_&&this.renderCurve(s,d),this.renderErrorBar(s,d),(_||c)&&this.renderDots(s,S,d),(!A||O)&&Pt.renderCallByParent(this.props,f))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:i.curPoints}:r.points!==i.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,i){for(var u=r.length%2!==0?[].concat(z(r),[0]):r,c=[],f=0;f<i;++f)c=[].concat(z(c),z(u));return c}},{key:"renderDotItem",value:function(r,i){var u;if(P.isValidElement(r))u=P.cloneElement(r,i);else if(bt(r))u=r(i);else{var c=i.key,f=lt(i,Mt),p=ot("recharts-line-dot",typeof r!="boolean"?r.className:"");u=P.createElement(jt,Z({key:c},f,{className:p}))}return u}}])})(w.PureComponent);T(B,"displayName","Line");T(B,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ot.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});T(B,"getComposedData",function(t){var a=t.props,n=t.xAxis,r=t.yAxis,i=t.xAxisTicks,u=t.yAxisTicks,c=t.dataKey,f=t.bandSize,p=t.displayedData,v=t.offset,j=a.layout,D=p.map(function(b,k){var g=ut(b,c);return j==="horizontal"?{x:it({axis:n,ticks:i,bandSize:f,entry:b,index:k}),y:rt(g)?null:r.scale(g),value:g,payload:b}:{x:rt(g)?null:n.scale(g),y:it({axis:r,ticks:u,bandSize:f,entry:b,index:k}),value:g,payload:b}});return N({points:D,layout:j},v)});var V=_t({chartName:"LineChart",GraphicalChild:B,axisComponents:[{axisType:"xAxis",AxisComp:R},{axisType:"yAxis",AxisComp:K}],formatAxisMap:Lt});function Jt(){const[t,a]=w.useState([]),[n,r]=w.useState([]),[i,u]=w.useState([]),[c,f]=w.useState([]),[p,v]=w.useState([]),[j,D]=w.useState(!0);w.useEffect(()=>{let s=!0;return(async()=>{try{const[d,o,l,m,h]=await Promise.all([ht(),yt(),xt(),gt(),vt(30).catch(()=>[])]);if(!s)return;a(d),r(o),u(l),f(m),v(h)}finally{s&&D(!1)}})(),()=>{s=!1}},[]);const b=w.useMemo(()=>{const s=new Map(n.map(o=>[o.id,o])),d={Todo:0,"In Progress":0,Complete:0};for(const o of i){const l=s.get(o.project_id);l&&l.archived||d[o.status]++}return{totalTasks:i.length,byStatus:d,totalPeople:t.length,totalProjects:n.length}},[t.length,n.length,i]),k=s=>s===1?.5:s===3?1:s===10?3:s===6?2:s===15?5:s===40?10:s===65?15:s===98?20:s===150?25:s===200?30:Math.max(0,Math.round(s/4)),g=w.useMemo(()=>{let s=0;for(const d of i)d.status!=="Complete"&&(!d.assignee_id||d.assignee_id==="")&&(typeof d.ranked_points=="number"?s+=k(d.ranked_points):s+=2);return Math.round(s)},[i]),A=w.useMemo(()=>{const s=new Map;for(const d of i){const o=d.completed_at??0;if(!o)continue;const l=new Date(o),m=l.getUTCFullYear(),h=new Date(Date.UTC(m,0,1)),y=Math.floor((l.getTime()-h.getTime())/864e5),F=Math.floor((y+h.getUTCDay())/7)+1,x=`${m}-W${String(F).padStart(2,"0")}`;s.set(x,(s.get(x)||0)+1)}return Array.from(s.entries()).map(([d,o])=>({week:d,completed:o})).sort((d,o)=>d.week.localeCompare(o.week))},[i]),C=w.useMemo(()=>{const s=new Date,d=[];for(let l=13;l>=0;l--){const m=new Date(s);m.setDate(s.getDate()-l);const h=m.toISOString().slice(0,10);d.push({day:h,completed:0})}const o=new Map(d.map((l,m)=>[l.day,m]));for(const l of i){if(!l.completed_at)continue;const m=new Date(l.completed_at).toISOString().slice(0,10),h=o.get(m);h!==void 0&&(d[h].completed+=1)}return d},[i]),O=w.useMemo(()=>{const s=C.findIndex(d=>d.completed>0);return s>2?C.slice(s-1):C},[C]),_=w.useMemo(()=>{const s=new Map,d=new Map(n.map(o=>[o.id,o]));for(const o of i){const l=d.get(o.project_id);if(l&&l.archived)continue;const m=l?.subsystem||"Unassigned",h=s.get(m)||{todo:0,progress:0,done:0};o.status==="Complete"?h.done+=1:o.status==="In Progress"?h.progress+=1:h.todo+=1,s.set(m,h)}return Array.from(s.entries()).map(([o,l])=>{const m=l.todo+l.progress+l.done,h=y=>m?Math.round(y/m*100):0;return{subsystem:o,total:m,todo:l.todo,progress:l.progress,done:l.done,todoPct:h(l.todo),progressPct:h(l.progress),donePct:h(l.done)}}).sort((o,l)=>o.subsystem.localeCompare(l.subsystem))},[n,i]);w.useMemo(()=>{const s=new Map;for(const o of i)o.status==="Complete"&&o.assignee_id&&s.set(o.assignee_id,(s.get(o.assignee_id)||0)+1);return t.map(o=>({name:o.name,completed:s.get(o.id)||0})).sort((o,l)=>l.completed-o.completed).slice(0,10)},[t,i]),w.useMemo(()=>{const s=new Map;for(const o of n)s.set(o.id,{total:0,done:0,name:o.name});for(const o of i){const l=s.get(o.project_id);l&&(l.total+=1,o.status==="Complete"&&(l.done+=1))}return Array.from(s.entries()).map(([o,l])=>({project:l.name,percent:l.total?Math.round(l.done/l.total*100):0})).sort((o,l)=>l.percent-o.percent).slice(0,10)},[n,i]);const M=w.useMemo(()=>{const d=new Date,o=[];for(let x=29;x>=0;x--){const S=new Date(d);S.setDate(d.getDate()-x),o.push(S.toISOString().slice(0,10))}const l=new Map(o.map((x,S)=>[x,S])),m=new Map(n.map(x=>[x.id,x])),h=new Set,y={};for(const x of o)y[x]={};for(const x of i){if(x.status!=="Complete"||!x.completed_at)continue;const S=new Date(x.completed_at).toISOString().slice(0,10);if(!l.has(S))continue;const q=m.get(x.project_id)?.subsystem||"Unassigned";h.add(q);const tt=typeof x.ranked_points=="number"?k(x.ranked_points):2;y[S][q]=(y[S][q]||0)+tt}const F=Array.from(h.values()).sort();return o.map(x=>{const S={day:x};for(const E of F)S[E]=y[x][E]||0;return S})},[n,i]),I=w.useMemo(()=>{const s=M;if(!s.length)return[];const d=Object.keys(s[0]).filter(m=>m!=="day"),o=.3,l={};return s.map(m=>{const h={day:m.day};return d.forEach(y=>h[y]=l[y]=l[y]==null?m[y]:o*m[y]+(1-o)*l[y]),h})},[M]),L=w.useMemo(()=>{const s=p.findIndex(d=>(d.visits||0)>0);return s>2?p.slice(s-1):p},[p]);return j?e.jsx("div",{className:"text-sm text-muted",children:"Loading stats…"}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold uppercase tracking-caps",children:"Stats"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:[e.jsx(W,{label:"Projects",value:b.totalProjects}),e.jsx(W,{label:"People",value:b.totalPeople}),e.jsx(W,{label:"Tasks",value:b.totalTasks}),e.jsx(W,{label:"Tasks Done",value:b.byStatus.Complete}),e.jsx(W,{label:"Unassigned Work",value:`${g} ${g===1?"hour":"hours"}`}),e.jsx(W,{label:"Visits Today",value:p.find(s=>s.date===new Date().toISOString().slice(0,10))?.visits??0})]}),e.jsx($,{title:"Tasks completed",subtitle:"Past 14 days",children:e.jsx("div",{className:"h-56",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(V,{data:O,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(R,{dataKey:"day",tick:{fill:"#BDC0C3",fontSize:11},minTickGap:12,angle:-30,textAnchor:"end",height:54,tickFormatter:s=>{const[d,o,l]=s.split("-").map(Number);return`${o}/${l}`}}),e.jsx(K,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},domain:[0,"dataMax + 1"],width:28}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(B,{type:"monotone",dataKey:"completed",stroke:"#34D399",strokeWidth:2,dot:!1})]})})})}),e.jsx($,{title:"Completions per week",children:e.jsx("div",{className:"h-56",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(V,{data:A,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(R,{dataKey:"week",hide:A.length>20,tick:{fill:"#BDC0C3",fontSize:11}}),e.jsx(K,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(nt,{}),e.jsx(B,{type:"monotone",dataKey:"completed",stroke:"#64C7C9",strokeWidth:2,dot:!1})]})})})}),e.jsx($,{title:"Subsystem status",subtitle:"Task counts",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-muted flex flex-wrap items-center gap-3 uppercase tracking-caps",children:[e.jsx("span",{className:"font-semibold text-white",children:"Legend"}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-success inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"Complete"})]}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-warning inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"In Progress"})]}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-muted/40 inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"Todo"})]}),e.jsx("span",{className:"text-[11px] text-muted/70 ml-auto md:ml-4 normal-case font-normal tracking-normal",children:"Left→Right: Complete · In Progress · Todo"})]}),e.jsxs("ul",{className:"space-y-2",children:[_.map(s=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-32 md:w-40 text-sm truncate",children:s.subsystem}),e.jsxs("div",{className:"flex-1 h-3 rounded bg-overlay-6 overflow-hidden flex",children:[e.jsx("div",{className:"h-full",style:{flexGrow:s.done,flexBasis:0,background:"#34D399"}}),e.jsx("div",{className:"h-full",style:{flexGrow:s.progress,flexBasis:0,background:"#FACC15"}}),e.jsx("div",{className:"h-full",style:{flexGrow:s.todo,flexBasis:0,background:"rgba(255,255,255,0.25)"}})]}),e.jsxs("div",{className:"hidden md:block w-28 text-right text-xs text-muted",children:[s.done,"/",s.total," done"]})]},s.subsystem)),_.length===0&&e.jsx("li",{className:"text-sm text-muted",children:"No subsystem data"})]})]})}),e.jsx($,{title:"Attendance",subtitle:"Last 10 meetings",children:e.jsx("div",{className:"h-48",children:e.jsx(qt,{attendance:c})})}),e.jsx($,{title:"Daily hours by subsystem",subtitle:"Last 30 days",children:e.jsx("div",{className:"h-72",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(V,{data:M,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(R,{dataKey:"day",interval:2,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:60,tickFormatter:s=>{const[d,o,l]=s.split("-");return`${o}/${l}`}}),e.jsx(K,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},label:{value:"Hours",angle:-90,position:"insideLeft",fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(nt,{}),Array.from(new Set(n.map(s=>s.subsystem||"Unassigned")).values()).sort().map((s,d)=>{const o=["#64C7C9","#98D7D8","#34D399","#FACC15","#3BA7A9","#2E7D7F"];return e.jsx(B,{type:"monotone",dataKey:s,stroke:o[d%o.length],strokeWidth:2,dot:!1},s)})]})})})}),e.jsxs($,{title:"Daily hours by subsystem",subtitle:"Smoothed (α=0.3)",children:[e.jsx("div",{className:"h-72",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(V,{data:I,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(R,{dataKey:"day",interval:2,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:60,tickFormatter:s=>{const[d,o,l]=s.split("-");return`${o}/${l}`}}),e.jsx(K,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},label:{value:"Smoothed Hours",angle:-90,position:"insideLeft",fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(nt,{}),Object.keys(I[0]||{}).filter(s=>s!=="day").map((s,d)=>{const o=["#64C7C9","#98D7D8","#34D399","#FACC15","#3BA7A9","#2E7D7F"];return e.jsx(B,{type:"monotone",dataKey:s,stroke:o[d%o.length],strokeWidth:2,dot:!1},s)})]})})}),e.jsx("p",{className:"mt-2 text-tick text-muted",children:"Exponential smoothing (α=0.3) dampens spikes from large task completions while keeping trends clear. Raw totals (previous chart) remain the authoritative sum."})]}),e.jsx($,{title:"Daily visits",subtitle:"Last 30 days",children:e.jsx("div",{className:"h-56",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(V,{data:L,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsx(U,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(R,{dataKey:"date",interval:3,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:54,tickFormatter:s=>{const[d,o,l]=s.split("-");return`${o}/${l}`}}),e.jsx(K,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},width:28}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(B,{type:"monotone",dataKey:"visits",stroke:"#98D7D8",strokeWidth:2,dot:!1})]})})})})]})}function $({title:t,subtitle:a,children:n}){return e.jsxs("section",{className:"rounded-lg border border-border bg-overlay-6 p-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold uppercase tracking-caps mb-1",children:t}),a&&e.jsx("div",{className:"text-[11px] sm:text-xs text-muted mb-3 -mt-1",children:a}),!a&&e.jsx("div",{className:"mb-3"}),n]})}function W({label:t,value:a}){return e.jsxs("div",{className:"rounded-md border border-border bg-overlay-6 p-3 h-full flex flex-col justify-between",children:[e.jsx("div",{className:"text-[11px] sm:text-xs text-muted uppercase tracking-caps font-semibold",children:t}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-center leading-tight",children:a})]})}function qt({attendance:t}){const a=new Set([2,4,6]),n=new Date,r=[],i=p=>p.toISOString().slice(0,10),u=new Date(n.getFullYear(),n.getMonth(),n.getDate());for(;r.length<10;)a.has(u.getDay())&&r.push(i(u)),u.setDate(u.getDate()-1);const c=new Map(r.map(p=>[p,0]));for(const p of t)c.has(p.date)&&c.set(p.date,(c.get(p.date)||0)+1);const f=[...r].reverse().map(p=>{const v=new Date(p+"T00:00:00"),j=`${v.getMonth()+1}/${v.getDate()}`;return{date:p,label:j,attendees:c.get(p)||0}});return e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(V,{data:f,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"attLast10Line",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9"}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8"})]}),e.jsxs("linearGradient",{id:"attLast10Fill",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9",stopOpacity:.35}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8",stopOpacity:.05})]})]}),e.jsx(U,{strokeDasharray:"3 3",stroke:"#1f2937"}),e.jsx(R,{dataKey:"label",tick:{fill:"#9ca3af",fontSize:12},axisLine:!1,tickLine:!1}),e.jsx(K,{allowDecimals:!1,tick:{fill:"#9ca3af",fontSize:12},axisLine:!1,tickLine:!1,width:28}),e.jsx(H,{contentStyle:{background:"#0b1220",border:"1px solid #273042",borderRadius:8}}),e.jsx(Tt,{width:0,height:0}),e.jsx(Et,{type:"monotone",dataKey:"attendees",stroke:"none",fill:"url(#attLast10Fill)"}),e.jsx(B,{type:"monotone",dataKey:"attendees",stroke:"url(#attLast10Line)",strokeWidth:3,dot:{r:3,stroke:"#98D7D8"},activeDot:{r:5}})]})})}export{Jt as default};
