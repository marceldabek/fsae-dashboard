import{s as N,r as A,a as ht,b as yt,c as xt,N as gt,j as e}from"./index-B3EZ4WWh.js";import{u as vt,d as bt}from"./discordMapping-2wgKo4vO.js";import{i as jt,D as kt,f as At,E as Dt,L as rt,b as Q,c as wt,d as St,e as Z,g as Ct,h as at,j as Pt,k as Nt,l as ft,u as Ot,G as _t,m as it,n as Lt,X as K,Y as R,o as Tt,R as U,C as G,T as H,p as nt,A as Et,a as Bt}from"./AreaChart-DsmMzEAA.js";import{c as lt}from"./clsx-B-dksMZM.js";var Mt=["type","layout","connectNulls","ref"],It=["key"];function Y(t){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Y(t)}function ct(t,n){if(t==null)return{};var a=Ft(t,n),r,c;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(c=0;c<l.length;c++)r=l[c],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Ft(t,n){if(t==null)return{};var a={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(n.indexOf(r)>=0)continue;a[r]=t[r]}return a}function J(){return J=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},J.apply(this,arguments)}function dt(t,n){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),a.push.apply(a,r)}return a}function _(t){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?dt(Object(a),!0).forEach(function(r){T(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):dt(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function z(t){return zt(t)||Rt(t)||Kt(t)||$t()}function $t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kt(t,n){if(t){if(typeof t=="string")return st(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return st(t,n)}}function Rt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zt(t){if(Array.isArray(t))return st(t)}function st(t,n){(n==null||n>t.length)&&(n=t.length);for(var a=0,r=new Array(n);a<n;a++)r[a]=t[a];return r}function Wt(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function ut(t,n){for(var a=0;a<n.length;a++){var r=n[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mt(r.key),r)}}function Ut(t,n,a){return n&&ut(t.prototype,n),a&&ut(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gt(t,n,a){return n=tt(n),Ht(t,pt()?Reflect.construct(n,a||[],tt(t).constructor):n.apply(t,a))}function Ht(t,n){if(n&&(Y(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vt(t)}function Vt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pt=function(){return!!t})()}function tt(t){return tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},tt(t)}function Yt(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&ot(t,n)}function ot(t,n){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,c){return r.__proto__=c,r},ot(t,n)}function T(t,n,a){return n=mt(n),n in t?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a,t}function mt(t){var n=Xt(t,"string");return Y(n)=="symbol"?n:n+""}function Xt(t,n){if(Y(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,n);if(Y(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var B=(function(t){function n(){var a;Wt(this,n);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return a=Gt(this,n,[].concat(c)),T(a,"state",{isAnimationFinished:!0,totalLength:0}),T(a,"generateSimpleStrokeDasharray",function(d,f){return"".concat(f,"px ").concat(d-f,"px")}),T(a,"getStrokeDasharray",function(d,f,p){var y=p.reduce(function(C,L){return C+L});if(!y)return a.generateSimpleStrokeDasharray(f,d);for(var j=Math.floor(d/y),D=d%y,v=f-d,b=[],g=0,k=0;g<p.length;k+=p[g],++g)if(k+p[g]>D){b=[].concat(z(p.slice(0,g)),[D-k]);break}var P=b.length%2===0?[0,v]:[v];return[].concat(z(n.repeat(p,j)),z(b),P).map(function(C){return"".concat(C,"px")}).join(", ")}),T(a,"id",Ot("recharts-line-")),T(a,"pathRef",function(d){a.mainCurve=d}),T(a,"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0}),a.props.onAnimationEnd&&a.props.onAnimationEnd()}),T(a,"handleAnimationStart",function(){a.setState({isAnimationFinished:!1}),a.props.onAnimationStart&&a.props.onAnimationStart()}),a}return Yt(n,t),Ut(n,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,c){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.points,f=l.xAxis,p=l.yAxis,y=l.layout,j=l.children,D=At(j,Dt);if(!D)return null;var v=function(k,P){return{x:k.x,y:k.y,value:k.value,errorVal:ft(k.payload,P)}},b={clipPath:r?"url(#clipPath-".concat(c,")"):null};return N.createElement(rt,b,D.map(function(g){return N.cloneElement(g,{key:"bar-".concat(g.props.dataKey),data:d,xAxis:f,yAxis:p,layout:y,dataPointFormatter:v})}))}},{key:"renderDots",value:function(r,c,l){var d=this.props.isAnimationActive;if(d&&!this.state.isAnimationFinished)return null;var f=this.props,p=f.dot,y=f.points,j=f.dataKey,D=Q(this.props,!1),v=Q(p,!0),b=y.map(function(k,P){var C=_(_(_({key:"dot-".concat(P),r:3},D),v),{},{index:P,cx:k.x,cy:k.y,value:k.value,dataKey:j,payload:k.payload,points:y});return n.renderDotItem(p,C)}),g={clipPath:r?"url(#clipPath-".concat(c?"":"dots-").concat(l,")"):null};return N.createElement(rt,J({className:"recharts-line-dots",key:"dots"},g),b)}},{key:"renderCurveStatically",value:function(r,c,l,d){var f=this.props,p=f.type,y=f.layout,j=f.connectNulls;f.ref;var D=ct(f,Mt),v=_(_(_({},Q(D,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(l,")"):null,points:r},d),{},{type:p,layout:y,connectNulls:j});return N.createElement(wt,J({},v,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,c){var l=this,d=this.props,f=d.points,p=d.strokeDasharray,y=d.isAnimationActive,j=d.animationBegin,D=d.animationDuration,v=d.animationEasing,b=d.animationId,g=d.animateNewValues,k=d.width,P=d.height,C=this.state,L=C.prevPoints,I=C.totalLength;return N.createElement(St,{begin:j,duration:D,isActive:y,easing:v,from:{t:0},to:{t:1},key:"line-".concat(b),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(E){var O=E.t;if(L){var F=L.length/f.length,s=f.map(function(m,w){var M=Math.floor(w*F);if(L[M]){var x=L[M],S=Z(x.x,m.x),X=Z(x.y,m.y);return _(_({},m),{},{x:S(O),y:X(O)})}if(g){var q=Z(k*2,m.x),et=Z(P/2,m.y);return _(_({},m),{},{x:q(O),y:et(O)})}return _(_({},m),{},{x:m.x,y:m.y})});return l.renderCurveStatically(s,r,c)}var u=Z(0,I),o=u(O),i;if(p){var h="".concat(p).split(/[,\s]+/gim).map(function(m){return parseFloat(m)});i=l.getStrokeDasharray(o,I,h)}else i=l.generateSimpleStrokeDasharray(I,o);return l.renderCurveStatically(f,r,c,{strokeDasharray:i})})}},{key:"renderCurve",value:function(r,c){var l=this.props,d=l.points,f=l.isAnimationActive,p=this.state,y=p.prevPoints,j=p.totalLength;return f&&d&&d.length&&(!y&&j>0||!Ct(y,d))?this.renderCurveWithAnimation(r,c):this.renderCurveStatically(d,r,c)}},{key:"render",value:function(){var r,c=this.props,l=c.hide,d=c.dot,f=c.points,p=c.className,y=c.xAxis,j=c.yAxis,D=c.top,v=c.left,b=c.width,g=c.height,k=c.isAnimationActive,P=c.id;if(l||!f||!f.length)return null;var C=this.state.isAnimationFinished,L=f.length===1,I=lt("recharts-line",p),E=y&&y.allowDataOverflow,O=j&&j.allowDataOverflow,F=E||O,s=at(P)?this.id:P,u=(r=Q(d,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},o=u.r,i=o===void 0?3:o,h=u.strokeWidth,m=h===void 0?2:h,w=Pt(d)?d:{},M=w.clipDot,x=M===void 0?!0:M,S=i*2+m;return N.createElement(rt,{className:I},E||O?N.createElement("defs",null,N.createElement("clipPath",{id:"clipPath-".concat(s)},N.createElement("rect",{x:E?v:v-b/2,y:O?D:D-g/2,width:E?b:b*2,height:O?g:g*2})),!x&&N.createElement("clipPath",{id:"clipPath-dots-".concat(s)},N.createElement("rect",{x:v-S/2,y:D-S/2,width:b+S,height:g+S}))):null,!L&&this.renderCurve(F,s),this.renderErrorBar(F,s),(L||d)&&this.renderDots(F,x,s),(!k||C)&&Nt.renderCallByParent(this.props,f))}}],[{key:"getDerivedStateFromProps",value:function(r,c){return r.animationId!==c.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:c.curPoints}:r.points!==c.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,c){for(var l=r.length%2!==0?[].concat(z(r),[0]):r,d=[],f=0;f<c;++f)d=[].concat(z(d),z(l));return d}},{key:"renderDotItem",value:function(r,c){var l;if(N.isValidElement(r))l=N.cloneElement(r,c);else if(jt(r))l=r(c);else{var d=c.key,f=ct(c,It),p=lt("recharts-line-dot",typeof r!="boolean"?r.className:"");l=N.createElement(kt,J({key:d},f,{className:p}))}return l}}])})(A.PureComponent);T(B,"displayName","Line");T(B,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!_t.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});T(B,"getComposedData",function(t){var n=t.props,a=t.xAxis,r=t.yAxis,c=t.xAxisTicks,l=t.yAxisTicks,d=t.dataKey,f=t.bandSize,p=t.displayedData,y=t.offset,j=n.layout,D=p.map(function(v,b){var g=ft(v,d);return j==="horizontal"?{x:it({axis:a,ticks:c,bandSize:f,entry:v,index:b}),y:at(g)?null:r.scale(g),value:g,payload:v}:{x:at(g)?null:a.scale(g),y:it({axis:r,ticks:l,bandSize:f,entry:v,index:b}),value:g,payload:v}});return _({points:D,layout:j},y)});var V=Lt({chartName:"LineChart",GraphicalChild:B,axisComponents:[{axisType:"xAxis",AxisComp:K},{axisType:"yAxis",AxisComp:R}],formatAxisMap:Tt});function ee(){const[t,n]=A.useState([]),{members:a}=vt(),[r,c]=A.useState([]),[l,d]=A.useState([]),[f,p]=A.useState([]),[y,j]=A.useState([]),[D,v]=A.useState(!0);A.useEffect(()=>{let s=!0;return(async()=>{try{const[u,o,i,h]=await Promise.all([ht(),yt(),xt(),gt(30).catch(()=>[])]);if(!s)return;c(u),d(o),p(i),j(h)}finally{s&&v(!1)}})(),()=>{s=!1}},[]),A.useEffect(()=>{n(bt(a))},[a]);const b=A.useMemo(()=>{const s=new Map(r.map(o=>[o.id,o])),u={Todo:0,"In Progress":0,Complete:0};for(const o of l){const i=s.get(o.project_id);i&&i.archived||u[o.status]++}return{totalTasks:l.length,byStatus:u,totalPeople:t.length,totalProjects:r.length}},[t.length,r.length,l]),g=s=>s===1?.5:s===3?1:s===10?3:s===6?2:s===15?5:s===40?10:s===65?15:s===98?20:s===150?25:s===200?30:Math.max(0,Math.round(s/4)),k=A.useMemo(()=>{let s=0;for(const u of l)u.status!=="Complete"&&(!u.assignee_id||u.assignee_id==="")&&(typeof u.ranked_points=="number"?s+=g(u.ranked_points):s+=2);return Math.round(s)},[l]),P=A.useMemo(()=>{const s=new Map;for(const u of l){const o=u.completed_at??0;if(!o)continue;const i=new Date(o),h=i.getUTCFullYear(),m=new Date(Date.UTC(h,0,1)),w=Math.floor((i.getTime()-m.getTime())/864e5),M=Math.floor((w+m.getUTCDay())/7)+1,x=`${h}-W${String(M).padStart(2,"0")}`;s.set(x,(s.get(x)||0)+1)}return Array.from(s.entries()).map(([u,o])=>({week:u,completed:o})).sort((u,o)=>u.week.localeCompare(o.week))},[l]),C=A.useMemo(()=>{const s=new Date,u=[];for(let i=13;i>=0;i--){const h=new Date(s);h.setDate(s.getDate()-i);const m=h.toISOString().slice(0,10);u.push({day:m,completed:0})}const o=new Map(u.map((i,h)=>[i.day,h]));for(const i of l){if(!i.completed_at)continue;const h=new Date(i.completed_at).toISOString().slice(0,10),m=o.get(h);m!==void 0&&(u[m].completed+=1)}return u},[l]),L=A.useMemo(()=>{const s=C.findIndex(u=>u.completed>0);return s>2?C.slice(s-1):C},[C]),I=A.useMemo(()=>{const s=new Map,u=new Map(r.map(o=>[o.id,o]));for(const o of l){const i=u.get(o.project_id);if(i&&i.archived)continue;const h=i?.subsystem||"Unassigned",m=s.get(h)||{todo:0,progress:0,done:0};o.status==="Complete"?m.done+=1:o.status==="In Progress"?m.progress+=1:m.todo+=1,s.set(h,m)}return Array.from(s.entries()).map(([o,i])=>{const h=i.todo+i.progress+i.done,m=w=>h?Math.round(w/h*100):0;return{subsystem:o,total:h,todo:i.todo,progress:i.progress,done:i.done,todoPct:m(i.todo),progressPct:m(i.progress),donePct:m(i.done)}}).sort((o,i)=>o.subsystem.localeCompare(i.subsystem))},[r,l]);A.useMemo(()=>{const s=new Map;for(const o of l)o.status==="Complete"&&o.assignee_id&&s.set(o.assignee_id,(s.get(o.assignee_id)||0)+1);return t.map(o=>({name:o.name,completed:s.get(o.id)||0})).sort((o,i)=>i.completed-o.completed).slice(0,10)},[t,l]),A.useMemo(()=>{const s=new Map;for(const o of r)s.set(o.id,{total:0,done:0,name:o.name});for(const o of l){const i=s.get(o.project_id);i&&(i.total+=1,o.status==="Complete"&&(i.done+=1))}return Array.from(s.entries()).map(([o,i])=>({project:i.name,percent:i.total?Math.round(i.done/i.total*100):0})).sort((o,i)=>i.percent-o.percent).slice(0,10)},[r,l]);const E=A.useMemo(()=>{const u=new Date,o=[];for(let x=29;x>=0;x--){const S=new Date(u);S.setDate(u.getDate()-x),o.push(S.toISOString().slice(0,10))}const i=new Map(o.map((x,S)=>[x,S])),h=new Map(r.map(x=>[x.id,x])),m=new Set,w={};for(const x of o)w[x]={};for(const x of l){if(x.status!=="Complete"||!x.completed_at)continue;const S=new Date(x.completed_at).toISOString().slice(0,10);if(!i.has(S))continue;const q=h.get(x.project_id)?.subsystem||"Unassigned";m.add(q);const et=typeof x.ranked_points=="number"?g(x.ranked_points):2;w[S][q]=(w[S][q]||0)+et}const M=Array.from(m.values()).sort();return o.map(x=>{const S={day:x};for(const X of M)S[X]=w[x][X]||0;return S})},[r,l]),O=A.useMemo(()=>{const s=E;if(!s.length)return[];const u=Object.keys(s[0]).filter(h=>h!=="day"),o=.3,i={};return s.map(h=>{const m={day:h.day};return u.forEach(w=>m[w]=i[w]=i[w]==null?h[w]:o*h[w]+(1-o)*i[w]),m})},[E]),F=A.useMemo(()=>{const s=y.findIndex(u=>(u.visits||0)>0);return s>2?y.slice(s-1):y},[y]);return D?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading stats…"}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold uppercase tracking-caps",children:"Stats"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:[e.jsx(W,{label:"Projects",value:b.totalProjects}),e.jsx(W,{label:"People",value:b.totalPeople}),e.jsx(W,{label:"Tasks",value:b.totalTasks}),e.jsx(W,{label:"Tasks Done",value:b.byStatus.Complete}),e.jsx(W,{label:"Unassigned Work",value:`${k} ${k===1?"hour":"hours"}`}),e.jsx(W,{label:"Visits Today",value:y.find(s=>s.date===new Date().toISOString().slice(0,10))?.visits??0})]}),e.jsx($,{title:"Tasks completed",subtitle:"Past 14 days",children:e.jsx("div",{className:"h-56",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:L,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"day",tick:{fill:"#BDC0C3",fontSize:11},minTickGap:12,angle:-30,textAnchor:"end",height:54,tickFormatter:s=>{const[u,o,i]=s.split("-").map(Number);return`${o}/${i}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},domain:[0,"dataMax + 1"],width:28}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(B,{type:"monotone",dataKey:"completed",stroke:"#34D399",strokeWidth:2,dot:!1})]})})})}),e.jsx($,{title:"Completions per week",children:e.jsx("div",{className:"h-56",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:P,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"week",hide:P.length>20,tick:{fill:"#BDC0C3",fontSize:11}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(nt,{}),e.jsx(B,{type:"monotone",dataKey:"completed",stroke:"#64C7C9",strokeWidth:2,dot:!1})]})})})}),e.jsx($,{title:"Subsystem status",subtitle:"Task counts",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-muted flex flex-wrap items-center gap-3 uppercase tracking-caps",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Legend"}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-success inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"Complete"})]}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-warning inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"In Progress"})]}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-muted/40 inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"Todo"})]}),e.jsx("span",{className:"text-[11px] text-muted-foreground ml-auto md:ml-4 normal-case font-normal tracking-normal",children:"Left→Right: Complete · In Progress · Todo"})]}),e.jsxs("ul",{className:"space-y-2",children:[I.map(s=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-32 md:w-40 text-sm truncate",children:s.subsystem}),e.jsxs("div",{className:"flex-1 h-3 rounded bg-surface overflow-hidden flex",children:[e.jsx("div",{className:"h-full",style:{flexGrow:s.done,flexBasis:0,background:"#34D399"}}),e.jsx("div",{className:"h-full",style:{flexGrow:s.progress,flexBasis:0,background:"#FACC15"}}),e.jsx("div",{className:"h-full",style:{flexGrow:s.todo,flexBasis:0,background:"rgba(255,255,255,0.25)"}})]}),e.jsxs("div",{className:"hidden md:block w-28 text-right text-xs text-muted-foreground",children:[s.done,"/",s.total," done"]})]},s.subsystem)),I.length===0&&e.jsx("li",{className:"text-sm text-muted-foreground",children:"No subsystem data"})]})]})}),e.jsx($,{title:"Attendance",subtitle:"Last 10 meetings",children:e.jsx("div",{className:"h-48",children:e.jsx(qt,{attendance:f})})}),e.jsx($,{title:"Daily hours by subsystem",subtitle:"Last 30 days",children:e.jsx("div",{className:"h-72",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:E,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"day",interval:2,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:60,tickFormatter:s=>{const[u,o,i]=s.split("-");return`${o}/${i}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},label:{value:"Hours",angle:-90,position:"insideLeft",fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(nt,{}),Array.from(new Set(r.map(s=>s.subsystem||"Unassigned")).values()).sort().map((s,u)=>{const o=["#64C7C9","#98D7D8","#34D399","#FACC15","#3BA7A9","#2E7D7F"];return e.jsx(B,{type:"monotone",dataKey:s,stroke:o[u%o.length],strokeWidth:2,dot:!1},s)})]})})})}),e.jsxs($,{title:"Daily hours by subsystem",subtitle:"Smoothed (α=0.3)",children:[e.jsx("div",{className:"h-72",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:O,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"day",interval:2,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:60,tickFormatter:s=>{const[u,o,i]=s.split("-");return`${o}/${i}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},label:{value:"Smoothed Hours",angle:-90,position:"insideLeft",fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(nt,{}),Object.keys(O[0]||{}).filter(s=>s!=="day").map((s,u)=>{const o=["#64C7C9","#98D7D8","#34D399","#FACC15","#3BA7A9","#2E7D7F"];return e.jsx(B,{type:"monotone",dataKey:s,stroke:o[u%o.length],strokeWidth:2,dot:!1},s)})]})})}),e.jsx("p",{className:"mt-2 text-tick text-muted-foreground",children:"Exponential smoothing (α=0.3) dampens spikes from large task completions while keeping trends clear. Raw totals (previous chart) remain the authoritative sum."})]}),e.jsx($,{title:"Daily visits",subtitle:"Last 30 days",children:e.jsx("div",{className:"h-56",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:F,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"date",interval:3,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:54,tickFormatter:s=>{const[u,o,i]=s.split("-");return`${o}/${i}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},width:28}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(B,{type:"monotone",dataKey:"visits",stroke:"#98D7D8",strokeWidth:2,dot:!1})]})})})})]})}function $({title:t,subtitle:n,children:a}){return e.jsxs("section",{className:"rounded-lg border border-border bg-card dark:bg-surface p-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold uppercase tracking-caps mb-1 text-foreground",children:t}),n&&e.jsx("div",{className:"text-[11px] sm:text-xs text-muted mb-3 -mt-1",children:n}),!n&&e.jsx("div",{className:"mb-3"}),a]})}function W({label:t,value:n}){return e.jsxs("div",{className:"rounded-md border border-border bg-card dark:bg-surface p-3 h-full flex flex-col justify-between",children:[e.jsx("div",{className:"text-[11px] sm:text-xs text-muted uppercase tracking-caps font-semibold",children:t}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-center leading-tight text-foreground",children:n})]})}function qt({attendance:t}){const n=new Set([2,4,6]),a=new Date,r=[],c=p=>p.toISOString().slice(0,10),l=new Date(a.getFullYear(),a.getMonth(),a.getDate());for(;r.length<10;)n.has(l.getDay())&&r.push(c(l)),l.setDate(l.getDate()-1);const d=new Map(r.map(p=>[p,0]));for(const p of t)d.has(p.date)&&d.set(p.date,(d.get(p.date)||0)+1);const f=[...r].reverse().map(p=>{const y=new Date(p+"T00:00:00"),j=`${y.getMonth()+1}/${y.getDate()}`;return{date:p,label:j,attendees:d.get(p)||0}});return e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:f,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"attLast10Line",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9"}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8"})]}),e.jsxs("linearGradient",{id:"attLast10Fill",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9",stopOpacity:.35}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8",stopOpacity:.05})]})]}),e.jsx(G,{strokeDasharray:"3 3",stroke:"#1f2937"}),e.jsx(K,{dataKey:"label",tick:{fill:"#9ca3af",fontSize:12},axisLine:!1,tickLine:!1}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#9ca3af",fontSize:12},axisLine:!1,tickLine:!1,width:28}),e.jsx(H,{contentStyle:{background:"#0b1220",border:"1px solid #273042",borderRadius:8}}),e.jsx(Et,{width:0,height:0}),e.jsx(Bt,{type:"monotone",dataKey:"attendees",stroke:"none",fill:"url(#attLast10Fill)"}),e.jsx(B,{type:"monotone",dataKey:"attendees",stroke:"url(#attLast10Line)",strokeWidth:3,dot:{r:3,stroke:"#98D7D8"},activeDot:{r:5}})]})})}export{ee as default};
