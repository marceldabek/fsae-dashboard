import{H as P,r as w,f as ht,a as yt,b as xt,c as gt,I as vt,j as e}from"./index-DD80bXAF.js";import{i as bt,D as jt,f as kt,E as At,L as et,b as J,c as Dt,d as wt,e as q,g as St,h as nt,j as Ct,k as Pt,l as ut,u as Nt,G as Ot,m as ot,n as _t,X as K,Y as R,o as Lt,R as U,C as G,T as H,p as rt,A as Tt,a as Et}from"./AreaChart-D9e1PF0x.js";import{c as it}from"./clsx-B-dksMZM.js";var Bt=["type","layout","connectNulls","ref"],It=["key"];function Y(t){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Y(t)}function lt(t,a){if(t==null)return{};var r=Mt(t,a),n,i;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(i=0;i<u.length;i++)n=u[i],!(a.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Mt(t,a){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(a.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Z(){return Z=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Z.apply(this,arguments)}function ct(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function N(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?ct(Object(r),!0).forEach(function(n){T(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function z(t){return Rt(t)||Kt(t)||$t(t)||Ft()}function Ft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $t(t,a){if(t){if(typeof t=="string")return at(t,a);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return at(t,a)}}function Kt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Rt(t){if(Array.isArray(t))return at(t)}function at(t,a){(a==null||a>t.length)&&(a=t.length);for(var r=0,n=new Array(a);r<a;r++)n[r]=t[r];return n}function zt(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function dt(t,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pt(n.key),n)}}function Wt(t,a,r){return a&&dt(t.prototype,a),r&&dt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ut(t,a,r){return a=Q(a),Gt(t,ft()?Reflect.construct(a,r||[],Q(t).constructor):a.apply(t,r))}function Gt(t,a){if(a&&(Y(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ht(t)}function Ht(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ft(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ft=function(){return!!t})()}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Q(t)}function Vt(t,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(a&&a.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),a&&st(t,a)}function st(t,a){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},st(t,a)}function T(t,a,r){return a=pt(a),a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function pt(t){var a=Yt(t,"string");return Y(a)=="symbol"?a:a+""}function Yt(t,a){if(Y(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,a);if(Y(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var B=(function(t){function a(){var r;zt(this,a);for(var n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];return r=Ut(this,a,[].concat(i)),T(r,"state",{isAnimationFinished:!0,totalLength:0}),T(r,"generateSimpleStrokeDasharray",function(c,p){return"".concat(p,"px ").concat(c-p,"px")}),T(r,"getStrokeDasharray",function(c,p,f){var v=f.reduce(function(O,_){return O+_});if(!v)return r.generateSimpleStrokeDasharray(p,c);for(var j=Math.floor(c/v),D=c%v,b=p-c,k=[],g=0,A=0;g<f.length;A+=f[g],++g)if(A+f[g]>D){k=[].concat(z(f.slice(0,g)),[D-A]);break}var C=k.length%2===0?[0,b]:[b];return[].concat(z(a.repeat(f,j)),z(k),C).map(function(O){return"".concat(O,"px")}).join(", ")}),T(r,"id",Nt("recharts-line-")),T(r,"pathRef",function(c){r.mainCurve=c}),T(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),T(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Vt(a,t),Wt(a,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var u=this.props,c=u.points,p=u.xAxis,f=u.yAxis,v=u.layout,j=u.children,D=kt(j,At);if(!D)return null;var b=function(A,C){return{x:A.x,y:A.y,value:A.value,errorVal:ut(A.payload,C)}},k={clipPath:n?"url(#clipPath-".concat(i,")"):null};return P.createElement(et,k,D.map(function(g){return P.cloneElement(g,{key:"bar-".concat(g.props.dataKey),data:c,xAxis:p,yAxis:f,layout:v,dataPointFormatter:b})}))}},{key:"renderDots",value:function(n,i,u){var c=this.props.isAnimationActive;if(c&&!this.state.isAnimationFinished)return null;var p=this.props,f=p.dot,v=p.points,j=p.dataKey,D=J(this.props,!1),b=J(f,!0),k=v.map(function(A,C){var O=N(N(N({key:"dot-".concat(C),r:3},D),b),{},{index:C,cx:A.x,cy:A.y,value:A.value,dataKey:j,payload:A.payload,points:v});return a.renderDotItem(f,O)}),g={clipPath:n?"url(#clipPath-".concat(i?"":"dots-").concat(u,")"):null};return P.createElement(et,Z({className:"recharts-line-dots",key:"dots"},g),k)}},{key:"renderCurveStatically",value:function(n,i,u,c){var p=this.props,f=p.type,v=p.layout,j=p.connectNulls;p.ref;var D=lt(p,Bt),b=N(N(N({},J(D,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(u,")"):null,points:n},c),{},{type:f,layout:v,connectNulls:j});return P.createElement(Dt,Z({},b,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,i){var u=this,c=this.props,p=c.points,f=c.strokeDasharray,v=c.isAnimationActive,j=c.animationBegin,D=c.animationDuration,b=c.animationEasing,k=c.animationId,g=c.animateNewValues,A=c.width,C=c.height,O=this.state,_=O.prevPoints,I=O.totalLength;return P.createElement(wt,{begin:j,duration:D,isActive:v,easing:b,from:{t:0},to:{t:1},key:"line-".concat(k),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(M){var L=M.t;if(_){var s=_.length/p.length,d=p.map(function(y,F){var x=Math.floor(F*s);if(_[x]){var S=_[x],E=q(S.x,y.x),X=q(S.y,y.y);return N(N({},y),{},{x:E(L),y:X(L)})}if(g){var tt=q(A*2,y.x),mt=q(C/2,y.y);return N(N({},y),{},{x:tt(L),y:mt(L)})}return N(N({},y),{},{x:y.x,y:y.y})});return u.renderCurveStatically(d,n,i)}var o=q(0,I),l=o(L),m;if(f){var h="".concat(f).split(/[,\s]+/gim).map(function(y){return parseFloat(y)});m=u.getStrokeDasharray(l,I,h)}else m=u.generateSimpleStrokeDasharray(I,l);return u.renderCurveStatically(p,n,i,{strokeDasharray:m})})}},{key:"renderCurve",value:function(n,i){var u=this.props,c=u.points,p=u.isAnimationActive,f=this.state,v=f.prevPoints,j=f.totalLength;return p&&c&&c.length&&(!v&&j>0||!St(v,c))?this.renderCurveWithAnimation(n,i):this.renderCurveStatically(c,n,i)}},{key:"render",value:function(){var n,i=this.props,u=i.hide,c=i.dot,p=i.points,f=i.className,v=i.xAxis,j=i.yAxis,D=i.top,b=i.left,k=i.width,g=i.height,A=i.isAnimationActive,C=i.id;if(u||!p||!p.length)return null;var O=this.state.isAnimationFinished,_=p.length===1,I=it("recharts-line",f),M=v&&v.allowDataOverflow,L=j&&j.allowDataOverflow,s=M||L,d=nt(C)?this.id:C,o=(n=J(c,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},l=o.r,m=l===void 0?3:l,h=o.strokeWidth,y=h===void 0?2:h,F=Ct(c)?c:{},x=F.clipDot,S=x===void 0?!0:x,E=m*2+y;return P.createElement(et,{className:I},M||L?P.createElement("defs",null,P.createElement("clipPath",{id:"clipPath-".concat(d)},P.createElement("rect",{x:M?b:b-k/2,y:L?D:D-g/2,width:M?k:k*2,height:L?g:g*2})),!S&&P.createElement("clipPath",{id:"clipPath-dots-".concat(d)},P.createElement("rect",{x:b-E/2,y:D-E/2,width:k+E,height:g+E}))):null,!_&&this.renderCurve(s,d),this.renderErrorBar(s,d),(_||c)&&this.renderDots(s,S,d),(!A||O)&&Pt.renderCallByParent(this.props,p))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:i.curPoints}:n.points!==i.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,i){for(var u=n.length%2!==0?[].concat(z(n),[0]):n,c=[],p=0;p<i;++p)c=[].concat(z(c),z(u));return c}},{key:"renderDotItem",value:function(n,i){var u;if(P.isValidElement(n))u=P.cloneElement(n,i);else if(bt(n))u=n(i);else{var c=i.key,p=lt(i,It),f=it("recharts-line-dot",typeof n!="boolean"?n.className:"");u=P.createElement(jt,Z({key:c},p,{className:f}))}return u}}])})(w.PureComponent);T(B,"displayName","Line");T(B,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Ot.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});T(B,"getComposedData",function(t){var a=t.props,r=t.xAxis,n=t.yAxis,i=t.xAxisTicks,u=t.yAxisTicks,c=t.dataKey,p=t.bandSize,f=t.displayedData,v=t.offset,j=a.layout,D=f.map(function(b,k){var g=ut(b,c);return j==="horizontal"?{x:ot({axis:r,ticks:i,bandSize:p,entry:b,index:k}),y:nt(g)?null:n.scale(g),value:g,payload:b}:{x:nt(g)?null:r.scale(g),y:ot({axis:n,ticks:u,bandSize:p,entry:b,index:k}),value:g,payload:b}});return N({points:D,layout:j},v)});var V=_t({chartName:"LineChart",GraphicalChild:B,axisComponents:[{axisType:"xAxis",AxisComp:K},{axisType:"yAxis",AxisComp:R}],formatAxisMap:Lt});function Qt(){const[t,a]=w.useState([]),[r,n]=w.useState([]),[i,u]=w.useState([]),[c,p]=w.useState([]),[f,v]=w.useState([]),[j,D]=w.useState(!0);w.useEffect(()=>{let s=!0;return(async()=>{try{const[d,o,l,m,h]=await Promise.all([ht(),yt(),xt(),gt(),vt(30).catch(()=>[])]);if(!s)return;a(d),n(o),u(l),p(m),v(h)}finally{s&&D(!1)}})(),()=>{s=!1}},[]);const b=w.useMemo(()=>{const s=new Map(r.map(o=>[o.id,o])),d={Todo:0,"In Progress":0,Complete:0};for(const o of i){const l=s.get(o.project_id);l&&l.archived||d[o.status]++}return{totalTasks:i.length,byStatus:d,totalPeople:t.length,totalProjects:r.length}},[t.length,r.length,i]),k=s=>s===1?.5:s===3?1:s===10?3:s===6?2:s===15?5:s===40?10:s===65?15:s===98?20:s===150?25:s===200?30:Math.max(0,Math.round(s/4)),g=w.useMemo(()=>{let s=0;for(const d of i)d.status!=="Complete"&&(!d.assignee_id||d.assignee_id==="")&&(typeof d.ranked_points=="number"?s+=k(d.ranked_points):s+=2);return Math.round(s)},[i]),A=w.useMemo(()=>{const s=new Map;for(const d of i){const o=d.completed_at??0;if(!o)continue;const l=new Date(o),m=l.getUTCFullYear(),h=new Date(Date.UTC(m,0,1)),y=Math.floor((l.getTime()-h.getTime())/864e5),F=Math.floor((y+h.getUTCDay())/7)+1,x=`${m}-W${String(F).padStart(2,"0")}`;s.set(x,(s.get(x)||0)+1)}return Array.from(s.entries()).map(([d,o])=>({week:d,completed:o})).sort((d,o)=>d.week.localeCompare(o.week))},[i]),C=w.useMemo(()=>{const s=new Date,d=[];for(let l=13;l>=0;l--){const m=new Date(s);m.setDate(s.getDate()-l);const h=m.toISOString().slice(0,10);d.push({day:h,completed:0})}const o=new Map(d.map((l,m)=>[l.day,m]));for(const l of i){if(!l.completed_at)continue;const m=new Date(l.completed_at).toISOString().slice(0,10),h=o.get(m);h!==void 0&&(d[h].completed+=1)}return d},[i]),O=w.useMemo(()=>{const s=C.findIndex(d=>d.completed>0);return s>2?C.slice(s-1):C},[C]),_=w.useMemo(()=>{const s=new Map,d=new Map(r.map(o=>[o.id,o]));for(const o of i){const l=d.get(o.project_id);if(l&&l.archived)continue;const m=l?.subsystem||"Unassigned",h=s.get(m)||{todo:0,progress:0,done:0};o.status==="Complete"?h.done+=1:o.status==="In Progress"?h.progress+=1:h.todo+=1,s.set(m,h)}return Array.from(s.entries()).map(([o,l])=>{const m=l.todo+l.progress+l.done,h=y=>m?Math.round(y/m*100):0;return{subsystem:o,total:m,todo:l.todo,progress:l.progress,done:l.done,todoPct:h(l.todo),progressPct:h(l.progress),donePct:h(l.done)}}).sort((o,l)=>o.subsystem.localeCompare(l.subsystem))},[r,i]);w.useMemo(()=>{const s=new Map;for(const o of i)o.status==="Complete"&&o.assignee_id&&s.set(o.assignee_id,(s.get(o.assignee_id)||0)+1);return t.map(o=>({name:o.name,completed:s.get(o.id)||0})).sort((o,l)=>l.completed-o.completed).slice(0,10)},[t,i]),w.useMemo(()=>{const s=new Map;for(const o of r)s.set(o.id,{total:0,done:0,name:o.name});for(const o of i){const l=s.get(o.project_id);l&&(l.total+=1,o.status==="Complete"&&(l.done+=1))}return Array.from(s.entries()).map(([o,l])=>({project:l.name,percent:l.total?Math.round(l.done/l.total*100):0})).sort((o,l)=>l.percent-o.percent).slice(0,10)},[r,i]);const I=w.useMemo(()=>{const d=new Date,o=[];for(let x=29;x>=0;x--){const S=new Date(d);S.setDate(d.getDate()-x),o.push(S.toISOString().slice(0,10))}const l=new Map(o.map((x,S)=>[x,S])),m=new Map(r.map(x=>[x.id,x])),h=new Set,y={};for(const x of o)y[x]={};for(const x of i){if(x.status!=="Complete"||!x.completed_at)continue;const S=new Date(x.completed_at).toISOString().slice(0,10);if(!l.has(S))continue;const X=m.get(x.project_id)?.subsystem||"Unassigned";h.add(X);const tt=typeof x.ranked_points=="number"?k(x.ranked_points):2;y[S][X]=(y[S][X]||0)+tt}const F=Array.from(h.values()).sort();return o.map(x=>{const S={day:x};for(const E of F)S[E]=y[x][E]||0;return S})},[r,i]),M=w.useMemo(()=>{const s=I;if(!s.length)return[];const d=Object.keys(s[0]).filter(m=>m!=="day"),o=.3,l={};return s.map(m=>{const h={day:m.day};return d.forEach(y=>h[y]=l[y]=l[y]==null?m[y]:o*m[y]+(1-o)*l[y]),h})},[I]),L=w.useMemo(()=>{const s=f.findIndex(d=>(d.visits||0)>0);return s>2?f.slice(s-1):f},[f]);return j?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading stats…"}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold uppercase tracking-caps",children:"Stats"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:[e.jsx(W,{label:"Projects",value:b.totalProjects}),e.jsx(W,{label:"People",value:b.totalPeople}),e.jsx(W,{label:"Tasks",value:b.totalTasks}),e.jsx(W,{label:"Tasks Done",value:b.byStatus.Complete}),e.jsx(W,{label:"Unassigned Work",value:`${g} ${g===1?"hour":"hours"}`}),e.jsx(W,{label:"Visits Today",value:f.find(s=>s.date===new Date().toISOString().slice(0,10))?.visits??0})]}),e.jsx($,{title:"Tasks completed",subtitle:"Past 14 days",children:e.jsx("div",{className:"h-56",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:O,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"day",tick:{fill:"#BDC0C3",fontSize:11},minTickGap:12,angle:-30,textAnchor:"end",height:54,tickFormatter:s=>{const[d,o,l]=s.split("-").map(Number);return`${o}/${l}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},domain:[0,"dataMax + 1"],width:28}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(B,{type:"monotone",dataKey:"completed",stroke:"#34D399",strokeWidth:2,dot:!1})]})})})}),e.jsx($,{title:"Completions per week",children:e.jsx("div",{className:"h-56",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:A,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"week",hide:A.length>20,tick:{fill:"#BDC0C3",fontSize:11}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(rt,{}),e.jsx(B,{type:"monotone",dataKey:"completed",stroke:"#64C7C9",strokeWidth:2,dot:!1})]})})})}),e.jsx($,{title:"Subsystem status",subtitle:"Task counts",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-muted flex flex-wrap items-center gap-3 uppercase tracking-caps",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Legend"}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-success inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"Complete"})]}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-warning inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"In Progress"})]}),e.jsxs("span",{className:"flex items-center gap-1 normal-case",children:[e.jsx("span",{className:"w-3 h-3 rounded-sm bg-muted/40 inline-block"})," ",e.jsx("span",{className:"text-[11px]",children:"Todo"})]}),e.jsx("span",{className:"text-[11px] text-muted-foreground ml-auto md:ml-4 normal-case font-normal tracking-normal",children:"Left→Right: Complete · In Progress · Todo"})]}),e.jsxs("ul",{className:"space-y-2",children:[_.map(s=>e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-32 md:w-40 text-sm truncate",children:s.subsystem}),e.jsxs("div",{className:"flex-1 h-3 rounded bg-surface overflow-hidden flex",children:[e.jsx("div",{className:"h-full",style:{flexGrow:s.done,flexBasis:0,background:"#34D399"}}),e.jsx("div",{className:"h-full",style:{flexGrow:s.progress,flexBasis:0,background:"#FACC15"}}),e.jsx("div",{className:"h-full",style:{flexGrow:s.todo,flexBasis:0,background:"rgba(255,255,255,0.25)"}})]}),e.jsxs("div",{className:"hidden md:block w-28 text-right text-xs text-muted-foreground",children:[s.done,"/",s.total," done"]})]},s.subsystem)),_.length===0&&e.jsx("li",{className:"text-sm text-muted-foreground",children:"No subsystem data"})]})]})}),e.jsx($,{title:"Attendance",subtitle:"Last 10 meetings",children:e.jsx("div",{className:"h-48",children:e.jsx(Xt,{attendance:c})})}),e.jsx($,{title:"Daily hours by subsystem",subtitle:"Last 30 days",children:e.jsx("div",{className:"h-72",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:I,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"day",interval:2,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:60,tickFormatter:s=>{const[d,o,l]=s.split("-");return`${o}/${l}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},label:{value:"Hours",angle:-90,position:"insideLeft",fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(rt,{}),Array.from(new Set(r.map(s=>s.subsystem||"Unassigned")).values()).sort().map((s,d)=>{const o=["#64C7C9","#98D7D8","#34D399","#FACC15","#3BA7A9","#2E7D7F"];return e.jsx(B,{type:"monotone",dataKey:s,stroke:o[d%o.length],strokeWidth:2,dot:!1},s)})]})})})}),e.jsxs($,{title:"Daily hours by subsystem",subtitle:"Smoothed (α=0.3)",children:[e.jsx("div",{className:"h-72",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:M,margin:{left:8,right:8,top:8,bottom:8},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"day",interval:2,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:60,tickFormatter:s=>{const[d,o,l]=s.split("-");return`${o}/${l}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},label:{value:"Smoothed Hours",angle:-90,position:"insideLeft",fill:"#BDC0C3",fontSize:11}}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(rt,{}),Object.keys(M[0]||{}).filter(s=>s!=="day").map((s,d)=>{const o=["#64C7C9","#98D7D8","#34D399","#FACC15","#3BA7A9","#2E7D7F"];return e.jsx(B,{type:"monotone",dataKey:s,stroke:o[d%o.length],strokeWidth:2,dot:!1},s)})]})})}),e.jsx("p",{className:"mt-2 text-tick text-muted-foreground",children:"Exponential smoothing (α=0.3) dampens spikes from large task completions while keeping trends clear. Raw totals (previous chart) remain the authoritative sum."})]}),e.jsx($,{title:"Daily visits",subtitle:"Last 30 days",children:e.jsx("div",{className:"h-56",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:L,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.10)"}),e.jsx(K,{dataKey:"date",interval:3,tick:{fill:"#BDC0C3",fontSize:11},angle:-30,textAnchor:"end",height:54,tickFormatter:s=>{const[d,o,l]=s.split("-");return`${o}/${l}`}}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#BDC0C3",fontSize:11},width:28}),e.jsx(H,{contentStyle:{background:"#0F1B3A",border:"1px solid rgba(255,255,255,0.10)",borderRadius:8}}),e.jsx(B,{type:"monotone",dataKey:"visits",stroke:"#98D7D8",strokeWidth:2,dot:!1})]})})})})]})}function $({title:t,subtitle:a,children:r}){return e.jsxs("section",{className:"rounded-lg border border-border bg-card dark:bg-surface p-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold uppercase tracking-caps mb-1 text-foreground",children:t}),a&&e.jsx("div",{className:"text-[11px] sm:text-xs text-muted mb-3 -mt-1",children:a}),!a&&e.jsx("div",{className:"mb-3"}),r]})}function W({label:t,value:a}){return e.jsxs("div",{className:"rounded-md border border-border bg-card dark:bg-surface p-3 h-full flex flex-col justify-between",children:[e.jsx("div",{className:"text-[11px] sm:text-xs text-muted uppercase tracking-caps font-semibold",children:t}),e.jsx("div",{className:"text-lg sm:text-2xl font-bold text-center leading-tight text-foreground",children:a})]})}function Xt({attendance:t}){const a=new Set([2,4,6]),r=new Date,n=[],i=f=>f.toISOString().slice(0,10),u=new Date(r.getFullYear(),r.getMonth(),r.getDate());for(;n.length<10;)a.has(u.getDay())&&n.push(i(u)),u.setDate(u.getDate()-1);const c=new Map(n.map(f=>[f,0]));for(const f of t)c.has(f.date)&&c.set(f.date,(c.get(f.date)||0)+1);const p=[...n].reverse().map(f=>{const v=new Date(f+"T00:00:00"),j=`${v.getMonth()+1}/${v.getDate()}`;return{date:f,label:j,attendees:c.get(f)||0}});return e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(V,{data:p,margin:{top:6,right:10,left:4,bottom:4},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"attLast10Line",x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9"}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8"})]}),e.jsxs("linearGradient",{id:"attLast10Fill",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#64C7C9",stopOpacity:.35}),e.jsx("stop",{offset:"100%",stopColor:"#98D7D8",stopOpacity:.05})]})]}),e.jsx(G,{strokeDasharray:"3 3",stroke:"#1f2937"}),e.jsx(K,{dataKey:"label",tick:{fill:"#9ca3af",fontSize:12},axisLine:!1,tickLine:!1}),e.jsx(R,{allowDecimals:!1,tick:{fill:"#9ca3af",fontSize:12},axisLine:!1,tickLine:!1,width:28}),e.jsx(H,{contentStyle:{background:"#0b1220",border:"1px solid #273042",borderRadius:8}}),e.jsx(Tt,{width:0,height:0}),e.jsx(Et,{type:"monotone",dataKey:"attendees",stroke:"none",fill:"url(#attLast10Fill)"}),e.jsx(B,{type:"monotone",dataKey:"attendees",stroke:"url(#attLast10Line)",strokeWidth:3,dot:{r:3,stroke:"#98D7D8"},activeDot:{r:5}})]})})}export{Qt as default};
