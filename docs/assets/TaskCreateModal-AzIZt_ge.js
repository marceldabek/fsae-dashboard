import{r as a,j as e,t as I}from"./index-D3k_KiqT.js";import{C as P,a as _,b as M,c as A,P as V,d as D}from"./card-mTLGtmKA.js";import{M as L,a as O,D as E,S as u,b as x,d as m,e as j,f as r,I as B}from"./modal-nQA6oMK7.js";function W({open:p,onClose:d,people:g,projects:w=[],fixedProjectId:t,onCreated:k}){const[o,v]=a.useState(t||""),[l,b]=a.useState(""),[c,f]=a.useState("In Progress"),[n,S]=a.useState(""),[i,C]=a.useState(""),[h,N]=a.useState(!1);if(!p)return null;async function y(){if(h||!l.trim())return;const s=t||o;if(s){N(!0);try{try{console.log("[TaskCreateModal] create",{project_id:s,description:l.trim(),status:c,assignee_id:n||void 0,ranked_points:i||void 0})}catch{}await I({project_id:s,description:l.trim(),status:c,assignee_id:n||void 0,ranked_points:i||void 0}),b(""),f("In Progress"),S(""),C(""),t||v(""),k?.(),d()}finally{N(!1)}}}const T=!l.trim()||h||!(t||o);return e.jsx(L,{isOpen:p,onOpenChange:s=>{s||d()},className:"items-center",children:e.jsx(O,{children:e.jsx(E,{className:"w-full max-w-md",children:e.jsxs(P,{className:"shadow-2xl border-border overflow-hidden",children:[e.jsxs(_,{className:"flex items-center justify-between flex-row p-4 pb-2 border-b border-input",children:[e.jsx(M,{className:"text-lg",children:"Add Task"}),e.jsx("button",{onClick:d,"aria-label":"Close",className:"h-8 w-8 inline-flex items-center justify-center rounded hover:bg-foreground/10",children:e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs(A,{className:"p-4 pt-2 space-y-2",children:[!t&&e.jsxs(u,{value:o,onValueChange:v,children:[e.jsx(x,{className:"w-full",children:e.jsx(m,{placeholder:"Select project…"})}),e.jsx(j,{children:w.map(s=>e.jsx(r,{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{className:"h-9 text-sm rounded-md flex-1",placeholder:"Task title",value:l,onChange:s=>b(s.target.value)}),e.jsxs(u,{value:c,onValueChange:s=>f(s),children:[e.jsx(x,{className:"w-40 text-sm rounded-md h-9",children:e.jsx(m,{placeholder:"Status"})}),e.jsxs(j,{children:[e.jsx(r,{value:"Todo",children:"Todo"}),e.jsx(r,{value:"In Progress",children:"In Progress"}),e.jsx(r,{value:"Complete",children:"Complete"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(V,{mode:"single",people:g,selectedId:n||null,onSelect:s=>S(s||""),triggerLabel:n?g.find(s=>s.id===n)?.name||"Assignee":"Assign to…",buttonClassName:"px-3 h-9 rounded-md text-sm border border-input flex items-center whitespace-nowrap",maxItems:5}),e.jsxs(u,{value:i===""?"none":String(i),onValueChange:s=>C(s==="none"?"":Number(s)),children:[e.jsx(x,{className:"flex-1 text-sm rounded-md h-9",children:e.jsx(m,{placeholder:"Points (by estimated hours)"})}),e.jsxs(j,{children:[e.jsx(r,{value:"none",children:"No estimate"}),e.jsx(r,{value:"1",children:"1 pt ~ 0.5 hr"}),e.jsx(r,{value:"3",children:"3 pts ~ 1 hr"}),e.jsx(r,{value:"6",children:"6 pts ~ 2 hrs"}),e.jsx(r,{value:"10",children:"10 pts ~ 3 hrs"}),e.jsx(r,{value:"15",children:"15 pts ~ 5 hrs"}),e.jsx(r,{value:"40",children:"40 pts ~ 10 hrs"}),e.jsx(r,{value:"65",children:"65 pts ~ 15 hrs"}),e.jsx(r,{value:"98",children:"98 pts ~ 20 hrs"}),e.jsx(r,{value:"150",children:"150 pts ~ 25 hrs"}),e.jsx(r,{value:"200",children:"200 pts ~ 30 hrs"})]})]})]})]}),e.jsx(D,{className:"p-4 pt-2 border-t border-input",children:e.jsx("button",{onClick:y,disabled:T,className:"w-full h-9 rounded-md border border-input text-sm text-center bg-card dark:bg-surface hover:bg-card/80 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Saving…":"Save"})})]})})})})}export{W as T};
